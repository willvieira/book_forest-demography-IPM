[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Lab notebook",
    "section": "",
    "text": "Preface\nIn this book, I present the methods for quantifying the effect of competition and climate on the demographic dynamics of 31 North American forest trees. While I try my best to make this approach as transparent as possible, I will likely miss specific steps. In such cases, you can find the missing information within the accompanying code. If navigating my code was not enough to answer your question, feel free to email me.\nThis document is a dynamic report generated using R and Quarto. It is designed to ensure the reproducibility of the results, but note that some sections involve intensive computational processing. Rendering the entire document would require several days, mainly due to the Bayesian model fitting and sensitivity analysis of the IPM, which were executed on a cluster.\nI have included the code within this document to facilitate reproducibility, but specific code chunks have been turned off (using eval=FALSE). To replicate this vignette, you will need to download the complete dataset and parameters that are stored in the ownCloud server: (https://doc.ielab.usherbrooke.ca/s/83YSAiLAGeLm682. Note that the total size of the folder is approximately 40 GB. Once you have downloaded the parameters, create a file named _data.path and place it at the root of this project (./suppMaterial/_data.path). Inside this file, specify the local path of the downloaded data. For instance, if you download the full content of the server into the folder book_forest-demography-IPM/data/, the content of the _data.path file should be:\ndata/\nFinally, if Quarto and LaTex are installed, compile this document with:\nquarto render ."
  },
  {
    "objectID": "introduction.html",
    "href": "introduction.html",
    "title": "1  Introduction",
    "section": "",
    "text": "Climate warming poses a pressing challenge for several species, particularly for trees that are failing to follow temperature warming (Sittaro et al. 2017). Understanding the mechanisms governing species distribution is crucial for comprehending how they will respond to novel conditions arising from climate change. The niche theory predicts that a species thrives within a specific set of environmental conditions that allows it to have a positive growth rate (Hutchinson 1957). Assuming geographic distribution is a manifestation of individual performance, bottom-up demographic range models incorporate environmental factors influencing growth, survival, and recruitment and allow one to predict species distribution (Maguire Jr 1973; Holt 2009; Schurr et al. 2012). And this thing is what I tried to build during my thesis.\nHere, I use this book as a lab notebook to share all the details related to the model construction so it can be easily replicated and extended to others. The initial chapter covers the dataset description, the selected tree species, variables, and their computation methods.\nThis book unfolds in three separate parts. The first one describes the growth, survival, and recruitment demographic models. In the first chapter of this section (Chapter 3), we elucidate the ecological rationale behind each demographic model and its mathematical formulation. The following chapter (Chapter 4) details how we improved the base models by partitioning the variance between random and fixed effects. Here, we describe the ecological meaning behind the non-linear functions linking the climate and competition covariates to each demographic model. To finish this section, we describe the technical details of the model fit in Chapter 5, the comparison between the models in Chapter 6, and the practical information of how and where the model parameters are stored in Chapter 7.\nThe second section evaluates the fit of these models for 31 forest tree species using the selected model in Chapter 6. It begins by discussing the model parameters and their goodness of fit by comparing posterior distributions with trait observations from the literature. We evaluate the intercept parameters (Chapter 8) and the spatial random effects applied at the plot level (Chapter 9). We then discuss the effect of competition (Chapter 10) and climate (Chapter 11) covariates. Subsequently, we employ two approaches to gauge the effect size of each covariate. Specifically, we first compute the conditional effect of each covariate at the lower (1% quantile) and upper (99% quantile) distribution of the covariate (Chapter 12). This metric allows one to quantify the range of the intensity effect a species experienced from the covariate. Finally, we computed the average marginal effect of each covariate across the dataset (Chapter 13). This approach uses perturbation analysis to quantify the effect of each covariate on each observed measurement. It allows one to compare the marginal effect among species and demographic models.\nThe final section details the integration of growth, survival, and recruitment models into an Integral Projection Model (IPM). We start by describing the mathematical formulation of the IPM and its numerical approximation (Chapter 14). The second chapter (Chapter 15) is a practical guide detailing the use of the IPM code. The following chapter describes the sensitivity analysis for the IPM to the demographic model parameters (Chapter 16). There, we use a random forest algorithm to rank the relative importance of each parameter in changing the intrinsic population growth rate. The following two chapters describe each covariate’s conditional (Chapter 17) and marginal (Chapter 18) effects. Finally, we discuss the concept of suitable probability derived from the uncertainty around the population growth rate (Chapter 19).\n\n\n\n\nHolt, Robert D. 2009. “Bringing the Hutchinsonian Niche into the 21st Century: Ecological and Evolutionary Perspectives.” Proceedings of the National Academy of Sciences 106 (supplement_2): 19659–65.\n\n\nHutchinson, G Evelyn. 1957. “Concluding remarks.” In Cold Spring Harbor Symposium on Quantitative Biology, 22:415–27.\n\n\nMaguire Jr, Bassett. 1973. “Niche Response Structure and the Analytical Potentials of Its Relationship to the Habitat.” The American Naturalist 107 (954): 213–46.\n\n\nSchurr, Frank M., Jörn Pagel, Juliano Sarmento Cabral, Jürgen Groeneveld, Olga Bykova, Robert B. O’Hara, Florian Hartig, et al. 2012. “How to understand species’ niches and range dynamics: A demographic research agenda for biogeography.” Journal of Biogeography 39 (12): 2146–62. https://doi.org/10.1111/j.1365-2699.2012.02737.x.\n\n\nSittaro, Fabian, Alain Paquette, Christian Messier, and Charles A. Nock. 2017. “Tree range expansion in eastern North America fails to keep pace with climate warming at northern range limits.” Global Change Biology, 1–10. https://doi.org/10.1111/gcb.13622."
  },
  {
    "objectID": "db.html#covariates",
    "href": "db.html#covariates",
    "title": "2  Dataset",
    "section": "Covariates",
    "text": "Covariates\n\nCompetition index\nTo assess competition effects, we calculated the basal area (BA) of living individuals for each species-plot-year combination based on the dbh of each \\(i\\). We first calculated individual BA in \\(m^2\\) as follows:\n\\[\n    BA^{ind}_i = \\pi * (\\frac{dbh_i}{2 * 1000})^2\n\\]\nwhere the dbh is measured in millimeters. For a given plot \\(j\\), the total plot basal area in square meters per hectare (\\(m^2 ha^{-1}\\)) is defined as:\n\\[\n    BA^{plot}_j = \\sum_i^{n_j}{BA^{ind}_i} \\times \\frac{10000}{plot~area_j}\n\\]\nTo compute the basal area of larger individuals (BAL), we summed the total basal area of individuals whose dbh exceeded that of the focal individual \\(i\\) (\\(n_j > BA_i\\)):\n\\[\n    BAL^{plot}_{ij} = \\sum_i^{n_j > BA_i}{BA^{ind}_i} \\times \\frac{10000}{plot~area_j}\n\\]\nNote that BAL is now specific to the plot (\\(j\\)) and the individual (\\(i\\)).\n\n\nClimate\nWe obtained the 19 bioclimatic variables with a 10 \\(km^2\\) (300 arcsec) resolution grid, covering the period from 1970 to 2018. These climate variables were modeled using the ANUSPLIN interpolation method (McKenney et al. 2011). We used the plot’s longitude and latitude coordinates to extract the mean annual temperature (MAT) and mean annual precipitation (MAP). To incorporate the climate covariates in the dataset, we used each plot’s latitude and longitude coordinates to extract the mean annual temperature (MAT) and mean annual precipitation (MAP). In cases where plots did not fall within a valid pixel of the climate variable grid, we interpolated the climate condition using the eight neighboring cells. Due to the transitional nature of the dataset, we considered both the average and standard deviation of MAT and MAP over the years within each time interval. This approach allows us to account for climate’s averaged and temporal variability effects on tree demography. Finally, we normalized MAT and MAP within the 0 and 1 range, facilitating comparisons of optimal climate conditions and climate breadth among species."
  },
  {
    "objectID": "db.html#r-objects",
    "href": "db.html#r-objects",
    "title": "2  Dataset",
    "section": "R objects",
    "text": "R objects\nAll the scripts for dataset preparation are available at https://github.com/willvieira/TreesDemography within the R folder. These scripts detail the complete process of downloading, cleaning, and merging the data, resulting in the final datasets used in our study. Metadata associated with each script is described in Table Table 2.2.\n\ntreeData.RDS: This file contains the complete dataset in a tidy format, with one observation per row.\n\nFrom the treeData.RDS dataset, we derived four additional datasets, each representing the transition between time \\(t\\) and time $t + t`:\n\ngrowth_dt.RDS: Contains growth rate information between time \\(t\\) and \\(t + \\Delta t\\).\nstatus_dt.RDS: Contains individuals’ status (alive or dead) at both time \\(t\\) and time \\(t + \\Delta t\\).\nfec_dt.RDS: Contains ingrowth rate (number of individuals entering the population at 127 mm) between time \\(t\\) and \\(t + \\Delta t\\).\nsizeIngrowth_dt.RDS: Contains the size distribution of all individuals that entered the population for each remeasurement.\n\nYou can access all the data objects mentioned in the ownCloud folder via this link: doc.ielab.usherbrooke.ca/s/83YSAiLAGeLm682. In addition to the data objects, this folder contains three extra files:\n\nclimate_scaleRange.RDS contains the maximum and minimum values required to scale the climate covariates.\ndb_metadata.csv contains the csv description used in the table below.\nspecies_id.csv contains species descriptions and additional traits used in the analysis.\n\n\n\n\n\n\n\nTable 2.2:  Description of metadata for each variable linked to its corresponding dataset object (R object). Note that replicated variables shared among the R objects have been excluded. Consequently, there is no detailed description for the sizeIngrowth_dt dataset. \n  \n    \n    \n      R object\n      Variable\n      Description\n    \n  \n  \n    treeData\nplot_id\nplot ID\n    treeData\nlongitude\nlongitude crs(4326)\n    treeData\nlatitude\nlatitude crs(4326)\n    treeData\nplot_size\nsize of plot in m2\n    treeData\nBA_plot\ntotal plot basal area of alive individuals (m2/ha)\n    treeData\nBA_comp\nplot basal area of larger individuals (m2/ha)\n    treeData\nrelativeBA_comp\ndeprecated\n    treeData\ns_star\nthe height in which the canopy closes (meters)\n    treeData\ndb_origin\nif FIA or Quebec\n    treeData\nbio_01_mean\nmean of mean annual temperature for the years within the time interval\n    treeData\nbio_12_mean\nstandard deviation of mean annual temperature for the years within the time interval\n    treeData\nbio_01_sd\nsame as bi_01_mean, but for mean annual precipitation climate variable\n    treeData\nbio_12_sd\nsame as bio_01_sd, but for mean annual precipitation climate variable\n    treeData\nclimate_cellID\nthe climate cell ID in which the plot climate variables were extracted (similar between MAT and MAP\n    treeData\ntree_id\nthe unique ID for an individuala tree\n    treeData\nspecies_id\nspecies unique ID following the`species_id.csv` metadata file\n    treeData\nstatus\n0 = dead; 1 = alive\n    treeData\nyear_measured\nyear of field measurement\n    treeData\ndbh\ndiameter at breast height of the individual tree (milimiters)\n    treeData\nheight\nheight of the individiual tree (meters)\n    treeData\ncanopyDistance\ndifference between `height` and `s_star` meaning how far the individual is from the canopy close\n    treeData\nBA_sp\ntotal plot basal area of conspecific individuals (m2/ha)\n    treeData\nBA_inter\ntotal plot basal area of heterospecific individuals (m2/ha)\n    treeData\nBA_comp_sp\ntotal plot basal area of larger conspecific individuals (m2/ha)\n    treeData\nBA_comp_inter\ntotal plot basal area of larger heterospecific individuals (m2/ha)\n    treeData\nrelativeBA_sp\ndeprecated\n    treeData\nbio_01_mean_scl\nmean annual temperature normalized between 0 and 1\n    treeData\nbio_12_mean_scl\nmean annual precipitation normalized between 0 and 1\n    growth_dt\nyear0\ninitial year of reference for the time interval\n    growth_dt\nyear1\nfinal year of reference for the time interval\n    growth_dt\ndeltaYear\nyear1 - year0\n    growth_dt\ndbh0\ndiameter at breast height (mm) at year0\n    growth_dt\ndbh1\ndiameter at breast height (mm) at year1\n    growth_dt\ndeltaDbh\ndbh1 - dbh0\n    growth_dt\ngrowth\nannual growth rate (mm/year) [(dbh1 - dbh0)/deltaYear]\n    mort_dt\nmort\nalive (0) or dead (1) event between year0 and year1\n    fec_dt\nnbRecruit\nnumber of ingrowth (127 mm) betweem year0 and year1\n    fec_dt\nnbSapling\nsampling counts (note difference in protocols between FIA and Quebec)\n    fec_dt\nnbSeedling\nseedling counts (note difference in protocols between FIA and Quebec)\n    fec_dt\ndeltaYear_plot\nyear1 - year0\n    fec_dt\nplotSize_seedling\nsize of plot (m2) for seedling count\n    fec_dt\nplotSize_sapling\nsize of plot (m2) for sapling count\n    fec_dt\nBA_adult\nsimilar to BA_plot\n    fec_dt\nBA_adult_sp\nsimilar to BA_sp\n    fec_dt\nrelativeBA_adult_sp\ndeprecated\n  \n  \n  \n\n\n\n\n\n\n\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of North America: 1. Conifers; 2. Hardwoods Agriculture Handbook 654.” US Department of Agriculture, Forest Service, Washington, DC.\n\n\nMcKenney, Daniel W, Michael F Hutchinson, Pia Papadopol, Kevin Lawrence, John Pedlar, Kathy Campbell, Ewa Milewska, Ron F Hopkinson, David Price, and Tim Owen. 2011. “Customized Spatial Climate Models for North America.” Bulletin of the American Meteorological Society 92 (12): 1611–22.\n\n\nMinistere des Ressources Naturelles. 2016. “Norme d’inventaire ecoforestier: placettes-echantillons temporaires.” Direction des inventaires forestier, Ministère des Ressources naturelles,Québec.\n\n\nO’Connell, M B, E B LaPoint, J A Turner, T Ridley, D Boyer, A Wilson, K L Waddell, and B L Conkling. 2007. “The forest inventory and analysis database: Database description and users forest inventory and analysis program.” US Department of Agriculture, Forest Service."
  },
  {
    "objectID": "model_description.html#growth-model",
    "href": "model_description.html#growth-model",
    "title": "3  Model description",
    "section": "Growth model",
    "text": "Growth model\nTo characterize the annual growth rate in diameter at breast height (dbh) of an individual \\(i\\), we have chosen the von Bertalanffy growth equation (Von Bertalanffy 1957). From the initial size \\(z_i\\) of an individual at time \\(t\\), \\(z_{i, t}\\), the growth model predicts the size at time \\(t+\\Delta t\\) following:\n\\[\n  z_{i, t+\\Delta t} = z_{i,t}  \\times e^{-\\Gamma \\Delta t} + \\zeta_{\\infty} (1- e^{-\\Gamma \\Delta t})\n\\tag{3.1}\\]\nWhere \\(\\Delta t\\) is the time interval between the initial and final size measurements, \\(\\Gamma\\) represents a dimensionless growth rate coefficient. \\(\\zeta_{\\infty}\\) denotes the asymptotic size, which is the location at which growth approximates to zero.\nThe rationale behind this equation is that the growth rate exponentially decreases with size, converging to zero as size approaches \\(\\zeta_{\\infty}\\) (Figure 3.1). This assumption is particularly valuable in the context of the Integral Projection Models (described in Chapter 14), as it prevents eviction — where individuals are projected beyond the limits of the size distribution (\\([L, U]\\)) defined by the Kernel. The final likelihood growth model accounting for individual variability is defined as follows:\n\\[\n\\begin{align*}\n&dbh_{i,t + \\Delta t} \\sim N(\\mu, \\sigma) \\\\\n&\\mu = dbh_{i,t} \\times e^{-\\Gamma \\Delta t} + \\zeta_{\\infty} (1- e^{-\\Gamma \\Delta t})\n\\end{align*}\n\\]\nWhere \\(N\\) is the normal distribution and \\(dbh_i\\) is the observed size of an individual at two consecutive measurements.\n\n\n\n\n\nFigure 3.1: Illustration of the evolution of size (upper panels) and growth rate (bottom panels) over time following the von Bertalanffy growth equation. The three panels of each row are set to describe the interaction of the two parameters governing the annual growth rate of an individual tree."
  },
  {
    "objectID": "model_description.html#survival-model",
    "href": "model_description.html#survival-model",
    "title": "3  Model description",
    "section": "Survival model",
    "text": "Survival model\nThe chance of a mortality event (\\(M\\)) for an individual \\(i\\) within the time interval between \\(t\\) and \\(t+\\Delta t\\) is modeled as a Bernoulli distribution:\n\\[\nM_i \\sim Bernoulli(p_i)\n\\]\nHere, \\(M_i\\) represents the individual’s status (alive/dead) and \\(p_i\\) the mortality probability of the individual \\(i\\). The mortality probability is calculated based on the annual survival rate (\\(\\psi\\)) and the time interval between census (\\(\\Delta t\\)):\n\\[\np_i = 1 - \\psi^{\\Delta t}\n\\]\nThe rationale of this model is that the survival probability (\\(1 - p_i\\)) increases with the longevity parameter \\(\\psi\\), but it is compensated exponentially with the increase in time \\(\\Delta t\\) (Figure 3.2).\n\n\n\n\n\nFigure 3.2: Illustration of how the annual survival probability \\(\\psi\\) reduces with time interval."
  },
  {
    "objectID": "model_description.html#recruitment-model",
    "href": "model_description.html#recruitment-model",
    "title": "3  Model description",
    "section": "Recruitment model",
    "text": "Recruitment model\nWe opted to combine the data from both the U.S. and Quebec forest inventories to encompass a broader range of climatic conditions. However, we chose not to model their dynamics due to inconsistent protocols in recording seedlings, saplings, and juveniles between these two datasets. Instead, we quantified the recruitment rate (\\(I\\)) as the ingrowth of new individuals into the adult population, defined as those with a dbh exceeding 12.7 cm.\nSimilar to growth and survival, the count of ingrowth individuals (\\(I\\)) reaching the 12.7 cm size threshold depends on the time interval between measurements. Therefore, we introduce two parameters to control the potential number of recruited individuals. While the parameter \\(\\phi\\) determines the annual ingrowth rate per square meter, the parameter \\(\\rho\\) denotes the annual survival probability of each ingrowth individual:\n\\[\n  I \\sim Poisson(~\\phi \\times A \\times \\frac{1 - p^{\\Delta t}}{1-p}~)\n\\]\nWhere \\(A\\) represents the area of the plot in square meters. The rationale behind this model is that, between two measurements, new individuals enter the population annually at a rate of \\(\\phi\\), and their likelihood of surviving until the subsequent measurement (\\(\\rho\\)) declines over time (Figure 3.3).\n\n\n\n\n\nFigure 3.3: Illustration of how both ingrowth rate (\\(\\phi\\)) and the annual survival probability (\\(\\rho\\)) interact with time interval to determine the mean number of ingrowth."
  },
  {
    "objectID": "model_description.html#recruited-size-model",
    "href": "model_description.html#recruited-size-model",
    "title": "3  Model description",
    "section": "Recruited size model",
    "text": "Recruited size model\nIn the recruitment process, we determined a submodel to predict the size distribution of recruited individuals (\\(z_I\\)). The time interval between two measures is included in the model in the form of a linear predictor, where the mean size of recruited individuals increases with time as follows: To account for the time interval between the two measurements, we incorporated a linear predictor where the mean size of recruited individuals increases over time as follows:\n\\[\n  z_{I} \\sim TNormal(\\Omega + \\omicron \\Delta t,~\\sigma^{\\Omega}, ~ \\alpha, ~ \\beta)\n\\]\nTNormal is a truncated distribution with the lower and upper limits determined by the \\(\\alpha\\) and \\(\\beta\\) parameters, respectively. In our study, we have set \\(\\alpha\\) to 12.7 cm, aligning it with the ingrowth threshold, while \\(\\beta\\) is set to infinity to allow for an unbounded upper limit.\n\n\n\n\n\n\nVon Bertalanffy, Ludwig. 1957. “Quantitative Laws in Metabolism and Growth.” The Quarterly Review of Biology 32 (3): 217–31."
  },
  {
    "objectID": "covariates_description.html#plot-random-effects",
    "href": "covariates_description.html#plot-random-effects",
    "title": "4  Mixed covariates",
    "section": "Plot random effects",
    "text": "Plot random effects\nWe use random effects to account for the shared variance among individuals within the same plot in each demographic model. In the context of each species-demographic model combination, we draw plot random effects (\\(\\alpha_j\\)) from a normal distribution with a mean of zero, defined as:\n\\[\n  \\alpha_{j} \\sim N(0, \\sigma)\n\\]\nwhere \\(\\sigma\\) represents the variance among all plots \\(j\\). Note that both parameters, \\(\\alpha_j\\) and \\(\\sigma\\), are species and demographic model-specific. These plot random effects (\\(\\alpha_j\\)) serve to adjust the intercept parameters (\\(I\\)) within each demographic model as follows:\n\\[\n  I_j = \\overline{I} + \\alpha_j\n\\]\nWhere \\(I\\) can assume one of three forms: \\(\\Gamma\\) for the growth, \\(\\psi\\) for the survival, and \\(\\phi\\) for the recruitment model."
  },
  {
    "objectID": "covariates_description.html#size-effect",
    "href": "covariates_description.html#size-effect",
    "title": "4  Mixed covariates",
    "section": "Size effect",
    "text": "Size effect\nFor the growth model, the size effect is implicitly incorporated in the model. Specifically, following the von Bertalanffy model’s definition, an individual’s growth rate decreases exponentially with size, eventually reaching a zero growth rate as size approaches \\(\\zeta_{\\infty}\\) (Figure 4.1).\n\n\n\n\n\nFigure 4.1: Illustration of the effect of size on growth rate (left panel) and survival probability (right panel) for different sets of parameters.\n\n\n\n\nIn the survival model, the intercept longevity (\\(\\psi\\)) varies as a log-normal function of individual dbh as follows:\n\\[\n  \\psi + \\frac{ ln(\\frac{dbh}{\\upsilon}) }{\\sigma_{\\upsilon}}\n\\]\nHere, \\(\\upsilon\\) determines the size at which survival is optimal, and \\(\\sigma_{\\upsilon}\\) quantifies the extent of survival decrease from the optimal size. A higher parameter value corresponds to a reduced effect of size on the survival probability (Figure 4.1)."
  },
  {
    "objectID": "covariates_description.html#competition-effect",
    "href": "covariates_description.html#competition-effect",
    "title": "4  Mixed covariates",
    "section": "Competition effect",
    "text": "Competition effect\nWe use the basal area of larger individuals (BAL) as a metric for competition. We calculated basal area as the sum of the cross-sectional areas of all trees within a plot, derived from their diameter at breast height (dbh) measurements, and its unit is square meters per hectare. We calculate the competition intensity for each focal individual by summing the basal area of all individuals with a size greater than that of the focal individual. We differentiate this sum of basal area between conspecific and heterospecific individuals. More details can be found in the Chapter 2.\nBoth the growth (\\(\\Gamma\\)) and longevity (\\(\\psi\\)) intercept parameters decrease exponentially with BAL. This negative effect of BAL on growth and longevity is driven by two parameters that describe the effect of conspecific (\\(\\beta\\)) and heterospecific (\\(\\theta\\)) competition:\n\\[\n  \\Gamma + \\beta_{\\Gamma} \\times (BAL_{cons} + \\theta_{\\Gamma} \\times BAL_{het})\n\\]\n\\[\n  \\psi + \\beta_{\\psi} \\times (BAL_{cons} + \\theta_{\\psi} \\times BAL_{het})\n\\]\nWhen \\(\\theta < 1\\), it means that conspecific competition is stronger than heterospecific competition. Conversely, heterospecific competition prevails when \\(\\theta > 1\\), and when \\(\\theta = 1\\), there is no distinction between conspecific and heterospecific competition (Figure 4.2). Note that both \\(\\beta\\) and \\(\\theta\\) are unbounded parameters that either converge towards negative (indicating competition) or positive (indicating facilitation) values.\n\n\n\n\n\nFigure 4.2: Illustration of the impact of competition on growth and survival intercept parameters. The \\(\\beta\\) parameter governs the strength of competition, while the \\(\\theta\\) parameter determines the extent to which this intensity is transferred to heterospecific competition. In the left panel, heterospecific competition is weaker than conspecific competition (\\(\\theta < 1\\)), whereas in the right panel, heterospecific competition is stronger (\\(\\theta > 1\\)).\n\n\n\n\nFor the recruitment model, conspecific and heterospecific BAL affect different components of the model. Conspecific BAL, or the total conspecific plot basal area (as recruitment is necessarily smaller than any adult individual), has an unimodal effect on the annual ingrowth rate (\\(\\phi\\)). This effect is characterized by an optimal basal area for ingrowth at \\(\\delta^{\\phi}\\) and an increased effect controlled by the parameter \\(\\sigma^{\\phi}\\):\n\\[\n  \\phi - \\left(\\frac{BAL_{cons} - \\delta_{\\phi}}{\\sigma_{\\phi}}\\right)^2\n\\]\nThe underlying concept of this equation is that the ingrowth rate should increase with conspecific density, but only up to a certain point determined by \\(\\delta^{\\phi}\\). The ingrowth rate is expected to decrease at higher densities due to competition (Figure 4.3).\n\n\n\n\n\nFigure 4.3: Illustration of the impact of the conspecific basal area on the ingrowth rate and the impact of the total basal area on the survival rate of recruited individuals.\n\n\n\n\nFinally, the annual survival probability reduces exponentially with the total basal area of the plot, where there is no distinction between conspecific and heterospecific competition:\n\\[\n  \\rho + \\beta_{\\rho} \\times (BAL_{cons} +  BAL_{het})\n\\]"
  },
  {
    "objectID": "covariates_description.html#climate-effect",
    "href": "covariates_description.html#climate-effect",
    "title": "4  Mixed covariates",
    "section": "Climate effect",
    "text": "Climate effect\nAs we focus on inference rather than prediction, we chose not to conduct model selection concerning the climate variables. Instead, we opted for the mean annual temperature (MAT) and mean annual precipitation (MAP) as our chosen bioclimatic variables widely used for species distribution modeling. Each demographic function varies in function of a bell-shaped curve determined by an optimal climate condition (\\(\\xi\\)) and a climate breadth parameter (\\(\\sigma\\)) as follows:\n\\[\n  \\Gamma + \\left(\\frac{MAT - \\xi_{\\Gamma, MAT}}{\\sigma_{\\Gamma, MAT}}\\right)^2 + \\left(\\frac{MAP - \\xi_{\\Gamma, MAP}}{\\sigma_{\\Gamma, MAP}}\\right)^2\n\\]\n\\[\n  \\psi + \\left(\\frac{MAT - \\xi_{MAT}}{\\sigma_{\\psi, MAT}}\\right)^2 + \\left(\\frac{MAP - \\xi_{\\psi, MAP}}{\\sigma_{\\psi, MAP}}\\right)^2\n\\]\n\\[\n  \\phi + \\left(\\frac{MAT - \\xi_{\\psi, MAT}}{\\sigma_{\\psi, MAT}}\\right)^2 + \\left(\\frac{MAP - \\xi_{\\psi, MAP}}{\\sigma_{\\psi, MAP}}\\right)^2\n\\]\nThe climate breadth parameter (\\(\\sigma\\)) influences the strength of the specific climate variable’s effect on each demographic model (Figure 4.4). This unimodal function is flexible as it can assume various shapes to accommodate the data better. However, this flexibility also introduces the possibility of parameter degeneracy or redundancy, where different combinations of parameter values yield similar outcomes. To mitigate parameter degeneracy, we constrained the optimal climate condition parameter (\\(\\xi\\)) within the observed climate range for the species, thereby assuming that the optimal climate condition falls within our data range.\n\n\n\n\n\nFigure 4.4: Illustration of a hypothetical scaled climate variable’s impact on the growth, survival, and recruitment intercept parameters.\n\n\n\n\n\n\n\n\nBriscoe, Natalie J., Jane Elith, Roberto Salguero-Gómez, José J. Lahoz-Monfort, James S. Camac, Katherine M. Giljohann, Matthew H. Holden, et al. 2019. “Forecasting Species Range Dynamics with Process-Explicit Models: Matching Methods to Applications.” Ecology Letters 22 (11): 1940–56. https://doi.org/https://doi.org/10.1111/ele.13348.\n\n\nCsergő, Anna M., Roberto Salguero-Gómez, Olivier Broennimann, Shaun R. Coutts, Antoine Guisan, Amy L. Angert, Erik Welk, et al. 2017. “Less Favourable Climates Constrain Demographic Strategies in Plants.” Ecology Letters 20 (8): 969–80. https://doi.org/https://doi.org/10.1111/ele.12794.\n\n\nEttinger, Ailene, and Janneke HilleRisLambers. 2017. “Competition and facilitation may lead to asymmetric range shift dynamics with climate change.” Global Change Biology 23 (9): 3921–33. https://doi.org/10.1111/gcb.13649.\n\n\nGuyennon, Arnaud, Björn Reineking, Roberto Salguero-Gomez, Jonas Dahlgren, Aleksi Lehtonen, Sophia Ratcliffe, Paloma Ruiz-Benito, Miguel A. Zavala, and Georges Kunstler. 2023. “Beyond Mean Fitness: Demographic Stochasticity and Resilience Matter at Tree Species Climatic Edges.” Global Ecology and Biogeography 32 (4): 573–85. https://doi.org/https://doi.org/10.1111/geb.13640.\n\n\nIbáñez, Inés, Donald R. Zak, Andrew J. Burton, and Kurt S. Pregitzer. 2018. “Anthropogenic nitrogen deposition ameliorates the decline in tree growth caused by a drier climate.” Ecology, January. https://doi.org/10.1002/ecy.2095.\n\n\nKunstler, Georges, Arnaud Guyennon, Sophia Ratcliffe, Nadja Rüger, Paloma Ruiz-Benito, Dylan Z. Childs, Jonas Dahlgren, et al. 2021. “Demographic performance of European tree species at their hot and cold climatic edges.” Journal of Ecology 109 (2): 1041–54. https://doi.org/10.1111/1365-2745.13533.\n\n\nLe Squin, Amaël, Isabelle Boulangeat, and Dominique Gravel. 2021. “Climate-Induced Variation in the Demography of 14 Tree Species Is Not Sufficient to Explain Their Distribution in Eastern North America.” Global Ecology and Biogeography 30 (2): 352–69. https://doi.org/https://doi.org/10.1111/geb.13209.\n\n\nSeidl, Rupert, Mart-Jan Schelhaas, and Manfred J Lexer. 2011. “Unraveling the Drivers of Intensifying Forest Disturbance Regimes in Europe.” Global Change Biology 17 (9): 2842–52.\n\n\nTredennick, Andrew T., Giles Hooker, Stephen P. Ellner, and Peter B. Adler. 2021. “A Practical Guide to Selecting Models for Exploration, Inference, and Prediction in Ecology.” Ecology 102 (6): e03336. https://doi.org/https://doi.org/10.1002/ecy.3336.\n\n\nZhang, Jian, Shongming Huang, and Fangliang He. 2015. “Half-Century Evidence from Western Canada Shows Forest Dynamics Are Primarily Driven by Competition Followed by Climate.” Proceedings of the National Academy of Sciences 112 (13): 4009–14."
  },
  {
    "objectID": "model_fit.html",
    "href": "model_fit.html",
    "title": "5  Model fit",
    "section": "",
    "text": "We assessed the growth, survival, and recruitment rates by examining transitions between two measurements. While we fitted the growth and survival functions at the individual level, recruitment was evaluated at the plot level. Due to differences in measurement thresholds between the FIA and Quebec protocols, we only considered individuals with a dbh \\(\\ge\\) 127 mm. Therefore, we quantified the ingrowth rate as the number of individuals crossing the 127 mm threshold. We included trees with at least two measurements over time to quantify growth and survival. Similarly, we used plots with at least two measurements over time for ingrowth. To simplify the model hierarchy, we did not incorporate temporal models. Instead, we treated two transition measurements for the same individual as independent information. The plot random effects partially accounted for the variation at the individual level, where different individuals with multiple measurements shared the same variation.\nWe fitted each of the growth, survival, and recruitment models separately for each species, using the Hamiltonian Monte Carlo (HMC) algorithm via the Stan software (version 2.30.1 Team et al. 2022) and the cmdstandr R package (version 0.5.3 Gabry, Češnovar, and Johnson 2023). We conducted 2000 iterations for the warm-up and sampling phases for each of the four chains, resulting in 8000 posterior samples. However, we kept only the last 1000 iterations of the sampling phase to save computation time and storage space, resulting in 4000 posterior samples. We assessed model convergence using Stan’s \\(\\hat{R}\\) statistic, considering convergence achieved when \\(\\hat{R} < 1.05\\). The complete code used for data preparation, model execution, and diagnostic analysis is hosted at https://github.com/willvieira/TreesDemography. Diagnostic reports for all fitted models, including information on model convergence, parameter distributions, prediction checks, \\(R^2\\), and other metrics, are available at https://willvieira.github.io/TreesDemography/.\n\n\n\n\nGabry, Jonah, Rok Češnovar, and Andrew Johnson. 2023. Cmdstanr: R Interface to ’CmdStan’.\n\n\nTeam, Stan Development et al. 2022. “Stan Modeling Language Users Guide and Reference Manual, Version 2.30.1.” Stan Development Team."
  },
  {
    "objectID": "model_comparison.html#parameter-variance",
    "href": "model_comparison.html#parameter-variance",
    "title": "6  Model comparison",
    "section": "Parameter variance",
    "text": "Parameter variance\nThis section describes how the variance attributed to plot random effects changes with increasing model complexity. As we introduce covariates, it is expected that part of the variance in demographic rates, initially attributed to random effects, shifts towards the covariate fixed effects. Therefore, the larger the reduction in variance associated with plot random effects, the more significant the role of covariates in explaining demographic rates. The Figure 6.1 shows the \\(\\sigma_{plot}\\) change with increased model complexity for growth, survival, and recruitment vital rates.\n\n\n\n\n\n\n\n\nFigure 6.1: Boxplot shows the change in the posterior distribution of the parameter \\(\\sigma_{plot}\\) across the 31 tree species between the competing models. For each growth, survival, and recruitment vital rate, the simplest model (plot random effects only) increases in complexity with the addition of fixed size, competition, and climate covariates. Each colored dot represents the species’ average posterior distribution."
  },
  {
    "objectID": "model_comparison.html#model-predictive-accuracy",
    "href": "model_comparison.html#model-predictive-accuracy",
    "title": "6  Model comparison",
    "section": "Model predictive accuracy",
    "text": "Model predictive accuracy\nWe used pseudo \\(R^2\\) and MSE metrics derived from comparing observed and predicted values to evaluate the predictive accuracy of growth and recruitment demographic rates. Higher \\(R^2\\) values and lower MSE indicate better overall model accuracy. The Figure 6.2 and Figure 6.3 compare the growth and recruitment models using \\(R^2\\) and MSE, respectively.\n\n\n\n\n\n\n\n\nFigure 6.2: Posterior distribution of pseudo \\(R^2\\) across the 31 tree species between the competing models. For each growth, survival, and recruitment vital rate, the simplest model (plot random effects only) increases in complexity with the addition of fixed competition and climate covariates. Each colored dot represents the species’ average posterior distribution.\n\n\n\n\n\n\n\n\nFigure 6.3: Posterior distribution of Mean Squared Error (MSE) across the 31 tree species as models become more complex.\n\n\n\nWe used three complementary metrics for the survival model to assess model predictions. While the accuracy of classification models is often evaluated through the fraction of correct predictions, this measure can be misleading for unbalanced datasets such as mortality, where dead events are rare. To address this issue, we calculated sensitivity, which measures the percentage of dead trees correctly identified as dead (true positives). We also computed specificity, which measures the percentage of live trees correctly identified as alive (true negatives). The combination of sensitivity and specificity allows us to calculate corrected accuracy, considering the unbalanced accuracy predictions of positive and negative events (Figure 6.4).\n\n\n\n\n\n\n\n\nFigure 6.4: Comparing the posterior distribution of sensitivity, specificity, and accuracy across the 31 tree species between the competing models. Each colored dot represents the species’ average posterior distribution."
  },
  {
    "objectID": "model_comparison.html#leave-one-out-cross-validation",
    "href": "model_comparison.html#leave-one-out-cross-validation",
    "title": "6  Model comparison",
    "section": "Leave-one-out cross-validation",
    "text": "Leave-one-out cross-validation\nFinally, we evaluated the competing models using the LOO-CV metric, where models are compared based on the difference in the expected log pointwise predictive density (ELPD_diff). In cases involving multiple models, the difference is calculated relative to the model with highest ELPD (Vehtari, Gelman, and Gabry 2017). Consequently, the model with ELPD_diff equal to zero is defined as the best model. In contrast, the performance of the other models is assessed based on their deviation from the reference model in pointwise predictive cross-validation. Given the large number of observations in the dataset, we approximated LOO-CV using PSIS-LOO and subsampling. For each species, we approximated LOO-CV by sampling one-fifth of the total number of observations.\n\n\n\n\n\n\n\n\nFigure 6.5: Boxplot shows the LOO-CV compare between the competing models based on the expected log pointwise predictive density (ELPD_diff) difference across the 31 tree species. The sd_diff is the standard error of the ELPD difference between the model and the reference model (ELPD_diff equal to zero)."
  },
  {
    "objectID": "model_comparison.html#size-effect-in-survival",
    "href": "model_comparison.html#size-effect-in-survival",
    "title": "6  Model comparison",
    "section": "Size effect in survival",
    "text": "Size effect in survival\nWe initially incorporated the size effect into the survival models due to the structured-population approach. However, we observed that the effect of size on mortality probability was generally weak and variable among species, with no clear pattern of increased mortality probability with larger individual size. All models that included the size effect performed worse than the null model, which contained only plot random effects Figure 6.6.\n\n\n\n\n\n\n\n\nFigure 6.6: Boxplot shows the LOO-CV compare between the competing models based on the expected log pointwise predictive density (ELPD_diff) difference across the 31 tree species. The sd_diff is the standard error of the ELPD difference between the model and the reference model (ELPD_diff equal to zero)."
  },
  {
    "objectID": "model_comparison.html#conclusion",
    "href": "model_comparison.html#conclusion",
    "title": "6  Model comparison",
    "section": "Conclusion",
    "text": "Conclusion\nOur analysis revealed that incorporating competition into the growth, survival, and recruitment models proved more effective in gaining individual-level information than climate variables. The parameter \\(\\sigma_{plot}\\), interpreted as spatial heterogeneity, was lowest in the growth model, followed by recruitment and survival. As the models became more complex with the inclusion of covariates, recruitment exhibited the most significant reduction in spatial variance, followed by growth, with no clear pattern in the case of survival.\nRegarding predictive performance, competition contributed more to the overall predictive capacity (\\(R^2\\), MSE, and corrected accuracy) in the growth and survival models compared to climate variables. Although recruitment had the largest reduction in \\(\\sigma_{plot}\\), it had minimal impact on prediction accuracy.\nFinally, the LOO-CV indicates a clear trend where the complete model featuring plot random effects, competition, and climate covariates outperformed the other competing models. Furthermore, the absolute value of the ELPD shows that the growth model gained the most information from including covariates, followed by recruitment and survival models. Consequently, we selected the complete model with plot random effects, competition, and climate covariates as the preferred model for further analysis.\n\n\n\n\nVehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. “Practical Bayesian Model Evaluation Using Leave-One-Out Cross-Validation and WAIC.” Statistics and Computing 27: 1413–32."
  },
  {
    "objectID": "parameters_descr.html",
    "href": "parameters_descr.html",
    "title": "7  Parameters",
    "section": "",
    "text": "We stored the parameters for the demographic models in an ownCloud folder, which you can access via this link: doc.ielab.usherbrooke.ca/s/83YSAiLAGeLm682. The code used for model fitting, post-processing of model outputs, and diagnostic generation are available in the github.com/willvieira/TreesDemography GitHub repository. Specifically, for each demographic model, the script R/preparePosterior.R is used to transform Stan outputs into tidy RDS formats. These tidy parameters are stored in the folder named output_sim_processed, which is organized into subfolders for each demographic model. Within each demographic model folder are subfolders containing the fitted parameters for different models, ranging from the simplest intercept-only model (intcpt) to the more complete model (intcpt_plot_comp_clim). Inside each model folder, the parameters files are the posterior_pop_spID.RDS and posterior_plot_spID.RDS, where the pop refers to the species-level parameters, the plot for the plot-specific posterior draws, and spID to the species ID described in Table 2.1. Within each model folder, you will find parameter files named posterior_pop_spID.RDS and posterior_plot_spID.RDS, where pop refers to the species-level parameters, plots represents plot-specific posterior draws, and spID the species ID described in Table 2.1.\nThe R/preparePosterior.R script produces the diagnostics_spID.RDS and loo_spID.RDS files. The former contains diagnostic summary information from the Stan fit, including divergent transitions, E-BFMI (Effective Bayesian Fraction of Missing Information), and \\(\\hat{R}\\) statistics. The latter file contains the output of the Leave-One-Out Cross-Validation (LOO-CV). Furthermore, the model folders contain predictive performance metrics generated in the MCMCdiagnostics_vitalRate.Rmd report document. Specifically, it should contain the files MSE.RDS (Mean Squared Error) and R2.RDS (\\(R^2\\)) for the growth and recruitment models and the accur.RDS (accuracy) and R2.RDS for the survival model. Specifically, these folders contain the files MSE.RDS (Mean Squared Error) and R2.RDS (\\(R^2\\)) for the growth and recruitment models and accur.RDS (accuracy) and R2.RDS for the survival model. The output_sim_processed folder tree structure should look like this:\n\n\n                            levelName\n1  output_sim_processed              \n2   ¦--growth                        \n3   ¦   ¦--intcpt                    \n4   ¦   ¦--intcpt_plot               \n5   ¦   ¦--intcpt_plot_comp          \n6   ¦   °--intcpt_plot_comp_clim     \n7   ¦--mort                          \n8   ¦   ¦--intcpt                    \n9   ¦   ¦--intcpt_plot               \n10  ¦   ¦--intcpt_plot_comp          \n11  ¦   ¦--intcpt_plot_comp_clim     \n12  ¦   ¦--intcpt_plot_size          \n13  ¦   ¦--intcpt_plot_size_comp     \n14  ¦   °--intcpt_plot_size_comp_clim\n15  ¦--recruit                       \n16  ¦   ¦--intcpt                    \n17  ¦   ¦--intcpt_plot               \n18  ¦   ¦--intcpt_plot_comp          \n19  ¦   °--intcpt_plot_comp_clim     \n20  °--sizeIngrowth                  \n21      °--time_truc"
  },
  {
    "objectID": "pars_intercept.html#growth-rate",
    "href": "pars_intercept.html#growth-rate",
    "title": "8  Intercept",
    "section": "Growth rate",
    "text": "Growth rate\nBecause the growth rate intercept decreases non-linearly with size and is governed by the interaction of two parameters (\\(\\Gamma\\) and \\(\\zeta_{\\infty}\\)), we computed the average growth rate over a 10-year interval. Also, because the size of the individual is integrated into the Von Bertalanffy growth model, we computed the 10-year growth average starting from the lower size threshold of 12.7 cm, where growth is optimal.\n\n\n\n\n\nFigure 8.1: Intercept of the growth model using the 10-year average growth rate. Species are classified by their general growth trait following Burns, Honkala, et al. (1990)\n\n\n\n\nThe following figure compares the maximum observed size in the literature with the asymptotic size (\\(\\zeta_{\\infty}\\)), denoting the size where the growth rate converges to zero.\n\n\n\n\n\nFigure 8.2: Correlation between maximum observed size in literature following Burns, Honkala, et al. (1990) and estimated parameter \\(\\zeta_{\\infty}\\)"
  },
  {
    "objectID": "pars_intercept.html#mortality-probability",
    "href": "pars_intercept.html#mortality-probability",
    "title": "8  Intercept",
    "section": "Mortality probability",
    "text": "Mortality probability\nSimilar to the growth rate, the survival model has a temporal component in which survival probability (\\(\\psi\\)) decreases exponentially with time. So, we computed the 10-year average mortality probability as the intercept for the survival model.\n\n\n\n\n\nFigure 8.3: Intercept of the survival model using a 10-year mortality probability. Species are classified by their shade tolerance trait following Burns, Honkala, et al. (1990)\n\n\n\n\nAlternatively, we can also use the parameter \\(\\psi\\) to derive the expected longevity (\\(L\\)), which can be determined as \\(L = e^{\\psi}\\). The Figure 8.4 correlated the maximum size observed in the literature (Burns, Honkala, et al. 1990) with longevity (\\(L\\)).\n\n\n\n\n\nFigure 8.4: Correlation between maximum size observed in the literature (Burns, Honkala, et al. 1990) and the predicted longevity posterior distribution."
  },
  {
    "objectID": "pars_intercept.html#ingrowth-rate",
    "href": "pars_intercept.html#ingrowth-rate",
    "title": "8  Intercept",
    "section": "Ingrowth rate",
    "text": "Ingrowth rate\nThe ingrowth model comprises two intercept components: the annual ingrowth rate per square meter (\\(\\phi\\)) and the annual survival probability \\(\\rho\\). In the context of the survival submodel for the ingrowth rate, we computed the 10-year survival probability of ingrowth individuals just like in the survival model.\n\n\n\n\n\nFigure 8.5: Intercept of the ingrwoth model for the number of individuals that ingress the population per year per m\\(^2\\). Species are classified by their successional status following Burns, Honkala, et al. (1990).\n\n\n\n\n\n\n\n\n\nFigure 8.6: Intercept of the annual survival probability for the ingrowth model. Species are classified by their shade tolerance trait following Burns, Honkala, et al. (1990).\n\n\n\n\n\n\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of North America: 1. Conifers; 2. Hardwoods Agriculture Handbook 654.” US Department of Agriculture, Forest Service, Washington, DC.\n\n\nDı́az, Sandra, Jens Kattge, Johannes HC Cornelissen, Ian J Wright, Sandra Lavorel, Stéphane Dray, Björn Reu, et al. 2022. “The Global Spectrum of Plant Form and Function: Enhanced Species-Level Trait Dataset.” Scientific Data 9 (1): 755."
  },
  {
    "objectID": "pars_randomEffect.html#variance-among-plots",
    "href": "pars_randomEffect.html#variance-among-plots",
    "title": "9  Random effects",
    "section": "Variance among plots",
    "text": "Variance among plots\n\n\n\n\n\nFigure 9.1: Posterior distribution of variance in plot random effects across species and vital rates. Note that the parameter is in the scale of the intercept, so it is not comparable between demographic models."
  },
  {
    "objectID": "pars_randomEffect.html#intercept-random-effects",
    "href": "pars_randomEffect.html#intercept-random-effects",
    "title": "9  Random effects",
    "section": "Intercept + random effects",
    "text": "Intercept + random effects\nTo better understand how plot variation affects growth, survival, and recruitment, the following figures show the intercept distribution for each vital rate and the distribution of a randomly generated offset for plots based on their \\(\\sigma_{plot}\\) parameters.\n\nGrowth\n\n\n\n\n\nFigure 9.2: Posterior distribution of the growth rate intercept (red) and intercept with plot random effects (blue). Plot random effects were randomly generated using a normal distribution with zero mean and the posterior distribution of the among plot variance.\n\n\n\n\n\n\nSurvival\n\n\n\n\n\nFigure 9.3: Posterior distribution of the survival intercept (red) and the intercept with plot random effects (blue). Plot random effects were randomly generated using a normal distribution with zero mean and the posterior distribution of the among plot variance.\n\n\n\n\n\n\nRecruitment\n\n\n\n\n\nFigure 9.4: Posterior distribution of the survival intercept (red) and the intercept with plot random effects (blue). Plot random effects were randomly generated using a normal distribution with zero mean and the posterior distribution of the among plot variance."
  },
  {
    "objectID": "pars_randomEffect.html#correlation-in-plot-random-effects-among-species",
    "href": "pars_randomEffect.html#correlation-in-plot-random-effects-among-species",
    "title": "9  Random effects",
    "section": "Correlation in Plot Random Effects Among Species",
    "text": "Correlation in Plot Random Effects Among Species\nIn this section, we compare the correlation among species regarding the plot offset of each demographic model.\n\n\n\n\n\n\n\nGrowth\n\n\n\n\n\n\n\nSurvival\n\n\n\n\n\n\n\nRecruitment\n\n\n\n\n\n\n\nDistribution of the correlation among species par"
  },
  {
    "objectID": "pars_randomEffect.html#spatial-distribution-of-plot-random-effects",
    "href": "pars_randomEffect.html#spatial-distribution-of-plot-random-effects",
    "title": "9  Random effects",
    "section": "Spatial Distribution of Plot Random Effects",
    "text": "Spatial Distribution of Plot Random Effects\nOur modeling approach used a simple hierarchical model that did not explicitly account for the plot identity. However, this section allows us to explore potential spatial structure by visualizing the spatial distribution of the plot’s random effects. As illustrated in the figure below, we categorized the continuous offset values into nine distinct bin classes to aid visualization. To address the issue of overlapping points within the small figures, we use a transparency gradient that allows us to assign more emphasis to plots with higher absolute values."
  },
  {
    "objectID": "pars_competition.html#conspecific-and-heterospecific-effect",
    "href": "pars_competition.html#conspecific-and-heterospecific-effect",
    "title": "10  Competition effect",
    "section": "Conspecific and heterospecific effect",
    "text": "Conspecific and heterospecific effect\n\nGrowth\n\n\n\n\n\nFigure 10.1: Posterior distribution of conspecific and heterospecific density dependence across species (left panel) and species shade tolerance (right panel). Species are classified by their general growth trait following Burns, Honkala, et al. (1990)\n\n\n\n\n\n\nSurvival\n\n\n\n\n\nFigure 10.2: Posterior distribution of conspecific and heterospecific density dependence across species (left panel) and species shade tolerance (right panel). Species are classified by their general growth trait following Burns, Honkala, et al. (1990)\n\n\n\n\n\n\nGrowth vs survival\n\n\n\n\n\nFigure 10.3: Correlation between growth and survival density dependence parameters."
  },
  {
    "objectID": "pars_competition.html#total-basal-area-effect-on-recruitment-survival",
    "href": "pars_competition.html#total-basal-area-effect-on-recruitment-survival",
    "title": "10  Competition effect",
    "section": "Total basal area effect on recruitment survival",
    "text": "Total basal area effect on recruitment survival\n\n\n\n\n\nFigure 10.4: Posterior distribution of the density dependence parameter affecting the annual survival rate of recruitment individuals.\n\n\n\n\n\n\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of North America: 1. Conifers; 2. Hardwoods Agriculture Handbook 654.” US Department of Agriculture, Forest Service, Washington, DC."
  },
  {
    "objectID": "pars_climate.html#optimal-climate",
    "href": "pars_climate.html#optimal-climate",
    "title": "11  Climate effect",
    "section": "Optimal climate",
    "text": "Optimal climate\nFigure 11.1 and Figure 11.2 show the distribution of the optimal climate parameter, meaning the climate location where the vital rate is at its maximum, across the 31 tree species. The parameter mean and their uncertainty are displayed with the dot interval for growth (green), recruitment (yellow), and survival (brown). The density plot in light gray is the distribution of the climate variable among all observed trees across space and time.\n\nMean annual temperature\n\n\n\n\n\nFigure 11.1: Distribution for the optimal annual mean temperature (\\(\\xi_{MAT}\\)) for growth (green), recruitment (yellow), and survival (brown). The gray density plot is the annual mean temperature distribution among all observed trees across space and time.\n\n\n\n\n\n\nMean annual precipitation\n\n\n\n\n\nFigure 11.2: Distribution for the optimal mean annual precipitation (\\(\\xi_{MAP}\\)) for growth (green), recruitment (yellow), and survival (brown). The density plot in gray is the distribution of annual precipitation variable among all observed trees across space and time.\n\n\n\n\n\n\nOptimal temperature vs temperature mid range\n\n\n\n\n\nFigure 11.3: Optimal Mean annual temperature for the growth, survival, and recruitment models as function of each species midpoint temperature range.\n\n\n\n\n\n\nOptimal precipitaiton vs precipitation mid range\n\n\n\n\n\nFigure 11.4: Optimal Mean annual temperature for the growth, survival, and recruitment models as function of each species midpoint temperature range."
  },
  {
    "objectID": "pars_climate.html#climate-breadth",
    "href": "pars_climate.html#climate-breadth",
    "title": "11  Climate effect",
    "section": "Climate breadth",
    "text": "Climate breadth\nThe climate breadth is the second parameter to account for the climate effect on the growth, survival, and recruitment functions. We define climate breadth as the precision parameter, which is the inverse of the variance of the bell shape (\\(\\tau = \\frac{1}{\\sigma^2}\\)). The closer this value is to zero, the higher is the breadth around the mean. In other words, when climate breadth is zero, the bell-shaped unimodal function becomes an almost flat line.\n\nClimate breadth\n\n\n\n\n\nFigure 11.5: Mean annual temperature and mean annual precipitation effect size across the growth (green), recruitment (yellow), and survival (brown) vital rates. The higher the value, the stronger the negative effect of climate when moving from the optimal climate.\n\n\n\n\n\n\n\n\n\nFigure 11.6: Mean annual temperature and mean annual precipitation effect size across the growth (green), recruitment (yellow), and survival (brown) vital rates. The higher the value, the stronger the negative effect of climate when moving from the optimal climate.\n\n\n\n\n\n\n\n\n\n\nClimate breadth vs observed climate range size\nIn Figure 11.7, we plot the climate range size of a species with its climate breadth.\n\n\n\n\n\nFigure 11.7: Climate breadth in function of climate range size. The higher the climate range size, the more climate conditions the species experienced."
  },
  {
    "objectID": "pars_climate.html#conditional-effect-at-the-lower-and-upper-climate-range",
    "href": "pars_climate.html#conditional-effect-at-the-lower-and-upper-climate-range",
    "title": "11  Climate effect",
    "section": "Conditional effect at the lower and upper climate range",
    "text": "Conditional effect at the lower and upper climate range\nTo have an integral understanding of the climate effect across the range of the species, we computed the effect size of each climate variable on each vital rate for both the minimum and maximum observed climate conditions. Effect size ranges from zero (no effect) to 1 (maximum negative effect). We defined each species’ minimum and maximum climate conditions separately using the 0.1 and 99% quantile probability distributions. In Figure 11.8, we changed the signal of the lower minimum condition to negative to better visualize both lower and upper ranges but consider the absolute value.\n\n\n\n\n\n\n\n\nFigure 11.8: Mean annual temperature and mean annual precipitation effect size on growth, recruitment, and survival vital rates between the minimum and maximum observed climate condition. Note that the effect size ranges from 0 (no effect) to 1 (maximum negative effect), and the effect at the lower climate condition was converted to negative for visual clarity.\n\n\n\n\n\n\n\n\n\nFigure 11.9: Summary between the species of the climate effect size for each vital rate between the minimum and maximum observed climate condition."
  },
  {
    "objectID": "pars_effectSize.html#conditional-effect-size-at-lower-and-upper-covariate-range",
    "href": "pars_effectSize.html#conditional-effect-size-at-lower-and-upper-covariate-range",
    "title": "12  Conditional effect of covariates",
    "section": "Conditional effect size at lower and upper covariate range",
    "text": "Conditional effect size at lower and upper covariate range\n\nGrowth\n\n\n\n\n\nFigure 12.1: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species.\n\n\n\n\n\n\n\n\n\nFigure 12.2: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species.\n\n\n\n\n\n\nSurvival\n\n\n\n\n\nFigure 12.3: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species.\n\n\n\n\n\n\nRecruitment\n\n\n\n\n\nFigure 12.4: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species."
  },
  {
    "objectID": "pars_effectSize.html#effect-size-at-harsh-condition",
    "href": "pars_effectSize.html#effect-size-at-harsh-condition",
    "title": "12  Conditional effect of covariates",
    "section": "Effect size at harsh condition",
    "text": "Effect size at harsh condition\nHarsh condition is defined here as the extreme observed covariate with the largest conditional effect size between the 1% and 99% quantile distribution of the covariate.\n\n\n\n\n\nFigure 12.5: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species."
  },
  {
    "objectID": "pars_effectSize.html#effect-size-at-harsh-condition-grouped-by-range-position",
    "href": "pars_effectSize.html#effect-size-at-harsh-condition-grouped-by-range-position",
    "title": "12  Conditional effect of covariates",
    "section": "Effect size at harsh condition grouped by range position",
    "text": "Effect size at harsh condition grouped by range position\nNow, we using the effect size from the harsh condition (the lower or upper covariate quantile), we divide the effect size between three regions using the mean annual temperature (MAT) gradient: cold range (MAT < 10%), hot range (MAT > 90%), and the center otherwise.\n\n\n\n\nGrowth\n\n\n\n\n\nFigure 12.6: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species.\n\n\n\n\n\n\nSurvival\n\n\n\n\n\nFigure 12.7: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate had no effect on the intercept of the species.\n\n\n\n\n\n\nRecruitment\n\n\n\n\n\nFigure 12.8: Effect size of each covariate affecting growth at the lower (1% quantile) and upper (99% quantile) observed range of the covariate. Values close to zero mean that the covariate did not affect the intercept of the species."
  },
  {
    "objectID": "pars_condEffect.html",
    "href": "pars_condEffect.html",
    "title": "13  Average Marginal Effect",
    "section": "",
    "text": "In this section, we assess the impact of individual covariates on the growth, survival, and recruitment models. We employ the Average Marginal Effect (AME) to summarize the overall effect size of each covariate \\(x\\) on the response \\(y\\) across the dataset. For instance, we can use the AME to measure the relative effect of competition and climate on the survival function. In practice, the AME is estimated using partial derivatives. This involves evaluating the model’s output when one covariate is perturbed while keeping the others constant. To perturb each covariate \\(x\\), we begin by normalizing it within the range of \\([0-1]\\) using all observations across the 31 species as follows:\n\\[\n  x' = \\frac{x - \\text{min}(x)}{\\text{max}(x) - \\text{min}(x)}\n\\]\nwhere \\(x'\\) is the normalized vector of values for the covariate \\(x\\). We then increase the normalized values by a perturbation size \\(p\\) before transforming it back to the original scale:\n\\[\n\\begin{align*}\n&x_{\\epsilon} = (x' + p) (\\text{max}(x) -\\text{min}(x)) + \\text{min(x)} \\\\\n&h = x_{\\epsilon} - x\n\\end{align*}\n\\]\nWhere \\(x_{\\epsilon}\\) is the perturbed covariate in its original scale and \\(p\\) is the perturbation size set to 0.01. For each covariate \\(x\\), the average marginal effect (AME) across all observations \\(i\\) is estimated as follows:\n\\[\n  AME = \\frac{1}{n} \\sum_{i=1}^n \\frac{\\mid f(x_i + h, z_i, \\theta) - f(x_i, z_i, \\theta) \\mid}{h}\n\\]\n\\(f\\) denotes one of the growth, survival, or recruitment demographic models, \\(z\\) the remaining covariates retained at their original values, and \\(\\theta\\) is the collection of parameters. This approach is valuable because it captures the locally linearized effect of each observation. Furthermore, computing the average effect across the observed dataset considers the diversity in the distribution of each covariate, giving more weight to regions where observations are more prevalent.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAME per species\n\n\n\n\n\nFigure 13.1: Average Marginal effect of each covariate on the growth and survival vital rates. The larger the values, the stronger the marginal effect of the covariate across all observation for the species. Note that size (d.b.h.) is intrinsic to the growth equation model where annual growth rate reduces exponentialy with size reaching a growth rate of zero when size reaches \\(\\xi_{\\infty}\\), so the size AME is exactly ln(1) for all species.\n\n\n\n\n\n\nSummary of AME across species\n\n\n\n\n\nFigure 13.2: Average Marginal effect of each covariate grouped by species and their respective uncertainty. The larger the values, the stronger the marginal effect of the covariate across all observations for the species.\n\n\n\n\n\n\nAME of competition covariates grouped by shade tolerance\n\n\n\n\n\nFigure 13.3: Average Marginal effect of the competition covariates grouped by species shade tolerance and their respective uncertainty. The larger the values, the stronger the marginal effect of the covariate across all observations for the species.\n\n\n\n\n\n\nAME of temperature given the median latitude distribution of the species\n\n\n\n\n\nFigure 13.4: Average Marginal effect of Temperature in the function of the average latitudinal position of the species. The blue line is 50% quantile and the gray lines are the 25% and 75% quantiles."
  },
  {
    "objectID": "ipm_description.html#numerical-implementation",
    "href": "ipm_description.html#numerical-implementation",
    "title": "14  Integral Projection Model",
    "section": "Numerical implementation",
    "text": "Numerical implementation\nIn practice, we employ the mid-point rule to perform the discrete-form integration of the continuous kernel \\(K\\) (Ellner, Childs, and Rees 2016). While this approach is straightforward to implement, it comes with the trade-off of potentially introducing bias into estimates, particularly in the case of large matrices with overall slow growth rates, such as trees. Simulation analyses have shown that integration bins ranging from 0.1 to 1 cm are appropriate for obtaining reliable outputs (Zuidema et al. 2010). This study uses the lower proposed value of 0.1 cm size bins.\n\n\n\n\nEasterling, Michael R., Stephen P. Ellner, and Philip M. Dixon. 2000. “Size-specific sensitivity: applying a new structured population model.” Ecology 81 (3): 694–708. https://doi.org/10.1890/0012-9658(2000)081[0694:SSSAAN]2.0.CO;2.\n\n\nEllner, Stephen P, Dylan Z Childs, and Mark Rees. 2016. Data-driven modelling of structured populations. Springer.\n\n\nKohyama, Takashi. 1992. “Size-Structured Multi-Species Model of Rain Forest Trees.” Functional Ecology, 206–12.\n\n\nZuidema, Pieter A, Eelke Jongejans, Pham D Chien, Heinjo J During, and Feike Schieving. 2010. “Integral Projection Models for Trees: A New Parameterization Method and a Validation of Model Output.” Journal of Ecology 98 (2): 345–55."
  },
  {
    "objectID": "guide_IPM.html#loading-the-functions-and-parameters",
    "href": "guide_IPM.html#loading-the-functions-and-parameters",
    "title": "15  A guide to use the forest-IPM code",
    "section": "Loading the functions and parameters",
    "text": "Loading the functions and parameters\nWe start by sourcing the IPM-specific functions directly from GitHub:\n\nsuppressPackageStartupMessages(library(tidyverse))\n\nbaseURL <- 'https://raw.githubusercontent.com/willvieira/forest-IPM/master/R/'\n# source the three R scripts with the IPM functions\nc('vital_rates.R', 'kernel.R', 'BasalArea_competition.R') |>\n  walk(~source(paste0(baseURL, .x)))\n\nThe first wrapper function is the getPars_sp(), which loads species-specific parameters. The sp and path arguments define the species based on their ID, as outlined in Table 2.1, and specify the location path where these parameters are stored. The method argument allows you to specify whether you wish to load the mean value or a random draw from the posterior distribution for each parameter. The model argument defines which specific model you want to download the parameters. However, the IPM functions are currently available only for the complete model, so this argument should remain intcpt_plot_comp_clim.\n\npars_abibal <- getPars_sp(\n  sp = '18032ABIBAL',\n  method = 'mean', # `mean` or `random`\n  model = 'intcpt_plot_comp_clim',\n  path = file.path(readLines('_data.path'), 'output_sim_processed')\n)\n\nThe pars_abibal object is a simple list for each vital rate with named vectors representing the parameters associated with that particular vital rate.\n\n(pars_abibal)\n\n$growth\n        Beta         Lmax optimal_prec optimal_temp            r    sigma_obs \n -0.04082927 778.92148600   0.67333923   0.47041774  -4.34529798   7.95712862 \n  sigma_plot     tau_prec     tau_temp        theta \n  0.47382333   2.71067700  13.12657955   0.52418479 \n\n$mort\n        Beta optimal_prec optimal_temp          psi   sigma_plot     tau_prec \n-0.008103519  0.677269861  0.452655943  4.141692735  1.070949032  4.753038180 \n    tau_temp        theta \n 1.364021618  0.021797255 \n\n$rec\n      beta_p     mPop_log   optimal_BA optimal_prec optimal_temp        p_log \n 0.005473664 -6.097612710 22.210854250  0.675963964  0.464676533 -8.209122925 \n    sigma_BA   sigma_plot     tau_prec     tau_temp \n46.503604600  1.066220577  8.270941957 12.747742450 \n\n$sizeIngrowth\n   phi_time  sigma_size    size_int \n 3.57045138 49.59714057  0.03174647"
  },
  {
    "objectID": "guide_IPM.html#defining-model-conditions",
    "href": "guide_IPM.html#defining-model-conditions",
    "title": "15  A guide to use the forest-IPM code",
    "section": "Defining model conditions",
    "text": "Defining model conditions\nLet us establish the initial community structure based on the size of individuals. Populations are characterized by density functions that describe the distribution of individuals across the size range covered by the IPM (\\([L, U]\\)). In this context, we set the lower threshold of the size distribution (\\(L\\)) to 127 mm in dbh, following the FIA protocol. As the von Bertalanffy growth model incorporates a parameter that determines the size at which the growth rate converges to zero (\\(\\zeta_{\\infty}\\)), we define the upper boundary of the size distribution to be the species-specific \\(\\zeta_{\\infty}\\). The h argument specifies the bin size in millimeters for the discretized kernel, while N represents the total population size, defined as \\(\\int_L^{\\zeta_{\\infty}} n(z) \\mathrm{d}z\\). Given that this approach generates distributions randomly, the accuracy threshold determines the acceptance of the brute force approximation of the integral to match the expected population size N. Finally, the meanSize and sdSize are the parameters in the natural scale of the lognormal distribution used to generate random size distribution.\n\nN_sp <- init_pop(\n  params = pars_abibal,\n  L = 127,\n  h = 1,\n  N = 10,\n  accuracy = 0.001,\n  meanSize = 130,\n  sdSize = 1.8\n)\n\nThe N_sp object is also a list composed of the (i) species-specific mesh points (needed internally to build the kernel), the density function describing the distribution of individuals, and the h bin size.\n\n\nCode\nN_sp |>\n  enframe() |>\n  filter(name == 'Nvec') |>\n  unnest(value) |>\n  mutate(x = 127:(n() + 126)) |>\n  ggplot(aes(x, value)) +\n  geom_point(alpha = 0.5) +\n  geom_path() +\n  theme_minimal() +\n  labs(\n    x = 'Size (mm)',\n    y = 'Density'\n  )  \n\n\n\n\n\nFigure 15.1: Density function of size distribution across the \\([L, U]\\) kernerl threshold. This is stored in the N_sp$Nvec object. The dots are the discretized bin values.\n\n\n\n\nAdditionally, we need to create a second structured population vector for the heterospecific species. This vector will represent the size distribution of all species other than the focal species and will be used to compute the heterospecific competition effect.\nWhile we could use the init_pop() function as described above, with similar parameters except for the N, which can take any desired value, we will introduce a second approach. This alternative method allows us to approximate a continuous population vector based on observed dbh measurements. Given that we already have an object from the init_pop() function, we need to feed the dbh_to_sizeDist() function with the observed dbh values and the output of the init_pop() function as follows:\n\n# generate random observed values of dbh\nobs_dbh <- runif(2, 127, 500)\n# create a continuous population vector based on observed dbh measurements\nN_het <- dbh_to_sizeDist(\n  dbh = obs_dbh,\n  N_intra = N_sp\n)\n\nThe final condition parameters necessary to run the IPM model are:\n\ndelta_time = 1            # the time interval from $t$ to $t+1$. Usually set to 1.\nplotSize = 200            # plot size in squared meters\nTemp = 0.3                # mean annual temperature scaled between 0 and 1\nPrec = 0.8                # mean annual precipitation scaled between 0 and 1\nplot_random = rep(0, 3)   # plot random effects for c(growth, survival, and recruitment)"
  },
  {
    "objectID": "guide_IPM.html#run-the-ipm",
    "href": "guide_IPM.html#run-the-ipm",
    "title": "15  A guide to use the forest-IPM code",
    "section": "Run the IPM",
    "text": "Run the IPM\nThe primary function of the forest IPM is the mkKernel().\n\nK_abibal = mkKernel(\n  Nvec_intra = N_sp,\n  Nvec_inter = N_het,\n  delta_time = delta_time,\n  plotSize = plotSize,\n  Temp = Temp,\n  Prec = Prec,\n  pars = pars_abibal,\n  plot_random = plot_random\n)\n\nThe K_abibal object is a list of the \\(P\\), \\(F\\), and \\(K\\) matrices of dimension \\(z^2\\) as described in Equation 14.2. This kernel object is the core output of the IPM model, serving as the foundation for projecting populations over time or calculating the asymptotic population growth rate (\\(\\lambda\\)) and other metrics.\nWe can extract the asymptotic population growth rate (\\(\\lambda\\)) using the leading eigen value of the matrix \\(k\\):\n\n(max(Re(eigen(K_abibal$K)$values)))\n\n[1] 1.210677\n\n\nGiven that our matrix is density-dependent, we can project the population vector over time by continuously updating the Kernel at each time step to account for the evolving size distribution of individuals. In the following code, we demonstrate a simple loop to trace the evolving population over time while assuming that there is only conspecific density-dependence (N_het = 0). Note that this code is slow and can take 5-10 minutes to run due to the slow eigen() computation.\n\nset.seed(0.0)\n\n# Initial population size (small)\nN_sp <- init_pop(\n  params = pars_abibal,\n  L = 127,\n  h = 1,\n  N = 1\n)\n\n# define no heterospecific competition\nN_het <- init_pop(\n  params = pars_abibal,\n  L = 127,\n  h = 1,\n  N = 0\n)\n\n# generate initial Kernel\nK0 = mkKernel(\n  Nvec_intra = N_sp,\n  Nvec_inter = N_het,\n  delta_time = delta_time,\n  plotSize = plotSize,\n  Temp = Temp,\n  Prec = Prec,\n  pars = pars_abibal,\n  plot_random = plot_random\n)\n\n\ntime_max = 200\n# vector to save lambda over time\nlambdas = max(Re(eigen(K0$K)$values))\n# matrix to save size distribution\nntmat = matrix(0, nrow = length(N_sp$Nvec), ncol = time_max)\nntmat[, 1] <- N_sp$Nvec\n\nfor(Time in 2:time_max)\n{\n  # update the state\n  ntmat[, Time] <- K0$K %*% ntmat[, Time - 1]\n  N_sp$Nvec <- ntmat[, Time]\n\n  # update the kernel\n  K0 <- mkKernel(\n    Nvec_intra = N_sp,\n    Nvec_inter = N_het,\n    delta_time = delta_time,\n    plotSize = plotSize,\n    Temp = Temp,\n    Prec = Prec,\n    pars = pars_abibal,\n    plot_random = plot_random\n  )\n\n  # calculate pop growth rate\n  lambdas[Time] = max(Re(eigen(K0$K)$values))\n\n  cat(' Time step', Time, 'of', time_max, '(', round(Time/time_max * 100, 1), '%)\\r')\n}\n\n\n\n\nFor each time iteration, we saved the focal species’ size (\\(z\\)) distribution and the population growth rate (\\(\\lambda\\)). We can visualize how each measure involved time for these species-specific conditions. In Figure 15.2 and Figure 15.3, we can visualize how \\(\\lambda\\) and the size density distribution evolve.\n\n\nCode\nntmat |>\n  as_tibble() |>\n  pivot_longer(cols = everything(), values_to = 'Density') |>\n  mutate(Time = parse_number(name)) |>\n  group_by(Time) |>\n  reframe(N = sum(Density)) |>\n  left_join(\n    lambdas |>\n      enframe(name = 'Time') |>\n      rename(lambda = value)\n  ) |>\n  pivot_longer(cols = c(N, lambda)) |>\n  mutate(\n    name = factor(name, levels = c('N', 'lambda'), labels = c(expression(textstyle('Population size')), expression(lambda)))\n  ) |>\n  ggplot() +\n  aes(Time, value) +\n  facet_wrap(\n    ~name,\n    scales = 'free_y',\n    labeller = label_parsed\n  ) +\n  geom_path(linewidth = 1.2) +\n  theme_classic() +\n  labs(\n    y = NULL\n  )\n\n\n\n\n\nFigure 15.2: Population size (left panel) and population growth rate (right panel) over time.\n\n\n\n\n\n\nCode\nsuppressPackageStartupMessages(library(plotly))\n\nntmat |>\n  as.data.frame() |>\n  pivot_longer(cols = everything(), values_to = 'Density') |>\n  mutate(Time = parse_number(name)) |>\n  group_by(Time) |>\n    mutate(x = 127:(n() + 126)) |>\n  ggplot() +\n  aes(x, Density) +\n  aes(group = name) +\n  aes(frame = Time) +\n  geom_path() +\n  theme_classic() +\n  xlab('Size (mm)') ->\np\n\nggplotly(p) |>\n  animation_opts(frame = 50) |>\n  animation_slider(\n    hide = FALSE,\n    currentvalue = list(prefix = \"Time step: \", font = list(color = 'black'))\n  ) |>\n  animation_button(\n    x = 0.9, xanchor = 'left', y = 1, yanchor = 'top'\n  ) \n\n\n\n\n\nFigure 15.3: Population size distribution over time.\n\n\n\nWe can also see how these two quantities interact over time.\n\n\nCode\nntmat |>\n  as.data.frame() |>\n  pivot_longer(cols = everything())  |>\n  group_by(name) |>\n  reframe(N = sum(value)) |>\n  mutate(Time = parse_number(name)) |>\n  arrange(Time) |>\n  bind_cols(lambda = lambdas) |>\n  ggplot() +\n  aes(N, lambda) +\n  aes(color = Time) +\n  geom_path(linewidth = 1.2) +\n  theme_classic() +\n  labs(x = 'Population size', y = expression(lambda)) +\n  geom_hline(yintercept = 1, alpha = 0.2)\n\n\n\n\n\nFigure 15.4: Correlation between population growth rate and total population size over time."
  },
  {
    "objectID": "sens_analysis.html#simulation-summary",
    "href": "sens_analysis.html#simulation-summary",
    "title": "16  Sensitivity analysis",
    "section": "Simulation Summary",
    "text": "Simulation Summary\nThe final simulation involved a total of 93000 draws across species and different conditions. The Figure 16.1 illustrates the distribution of \\(\\lambda\\) computed using 500 random draws from the posterior distribution of parameters across different climate and competition conditions.\n\n\n\n\n\nFigure 16.1: Distribution of 500 draws of population growth rate \\(\\lambda\\) for different climate and competition conditions.\n\n\n\n\nThe Figure 16.2 presents the distribution of the average and standard deviation of \\(\\lambda\\) across the 500 draws for each species.\n\n\n\n\n\nFigure 16.2: Distribution of 500 draws of population growth rate \\(\\lambda\\) for different climate and competition conditions."
  },
  {
    "objectID": "sens_analysis.html#importance-of-demographic-models",
    "href": "sens_analysis.html#importance-of-demographic-models",
    "title": "16  Sensitivity analysis",
    "section": "Importance of demographic models",
    "text": "Importance of demographic models\nRandom forest is a non-parametric classification or regression model that ranks each input variable’s importance in explaining the variance of the response variable. We used the permutation method for ranking variable importance (Breiman 2001). This method measures the change in model performance by individually shuffling (permuting) the values of each input variable. The greater the change in predictive accuracy with shuffling input values, the more important the specific variable will become. This is computed individually for each tree and then averaged across all \\(n\\) random trees. Finally, we normalized the importance output of each regression model so that they sum to 1. We used the R package ranger with default hyperparameters for fitting the random forest models (Wright and Ziegler 2017).\nFigure Figure 16.3 shows the distribution of \\(R^2\\) from 20 random forest replications across different climate and competition conditions. These values range from 0.2 to 0.9, with an average value of 0.63 across species and conditions. This variation possibly reflects the uncertainty in the parameters across species.\n\n\n\n\n\nFigure 16.3: Distribution of \\(R^2\\) from 20 random forest replications across different climate and competition conditions.\n\n\n\n\nAs our primary interest lies in demographic levels rather than parameter levels, we focus on the combined importance of all parameters for each demographic model. This splits the total importance among the four demographic functions of the IPM: growth, survival, recruitment, and recruited size models. The recruited size model had an insignificant contribution to \\(\\lambda\\), with nearly all random forest models showing a contribution below 1%. Thus, we omitted this model and concentrated on the growth, survival, and recruitment models, which collectively explain over 99% of the variation in \\(\\lambda\\) Figure 16.4.\n\n\n\n\n\nFigure 16.4: Ternary plot describing the importance distribution among the growth, survival, and recruitment models. Color represents the level of shade tolerance (Burns, Honkala, et al. 1990).\n\n\n\n\nThe ternary plots above show the raw importance data from the random forest, which can be challenging to interpret. The key message is that variance in \\(\\lambda\\) is primarily explained by the recruitment and survival demographic models. Furthermore, certain conditions appear to shift the importance from recruitment to the survival model. In Figure 16.5, we explore the correlation between the importance of recruitment and survival under different covariate conditions.\n\n\n\n\n\nFigure 16.5: Correlation between the survival and recruitment relative importance across the 31 species, climate and competition conditions. Species points are grouped by a Multivariate Normal Density function with a probability of 90%.\n\n\n\n\nWe observe that at low competition, for most species, variations in \\(\\lambda\\) are primarily explained by recruitment. This pattern slightly diminishes as we move from the cold range to the center and up to the hot temperature range. We can observe an overall shift toward the survival model at high competition intensity, especially in the hot temperature range."
  },
  {
    "objectID": "sens_analysis.html#importance-of-covariates",
    "href": "sens_analysis.html#importance-of-covariates",
    "title": "16  Sensitivity analysis",
    "section": "Importance of covariates",
    "text": "Importance of covariates\nSimilar to assessing parameter importance, we also used the random forest approach to evaluate the importance of covariates. For simplicity, we used the same output of the simulations as previously explained, shifting the explanatory variables from parameters to covariates.1 The Figure 16.6 shows the distribution of relative importance between climate and competition covariates for each species.\n\n\n\n\n\nFigure 16.6: Distribution of relative importance between climate and competition covariates according to Random Forest, the respective \\(R^2\\). The more species are to the right of the panel, the more climate is important relative to competition. Color represents the level of shade tolerance (Burns, Honkala, et al. 1990)."
  },
  {
    "objectID": "sens_analysis.html#notes-on-conspecific-and-heterospecific-competition-effects",
    "href": "sens_analysis.html#notes-on-conspecific-and-heterospecific-competition-effects",
    "title": "16  Sensitivity analysis",
    "section": "Notes on Conspecific and Heterospecific Competition Effects",
    "text": "Notes on Conspecific and Heterospecific Competition Effects\nIn the preceding discussion, we did not specify whether we were considering conspecific or heterospecific competition. For all the results presented in this chapter, the high competition condition was applied at the heterospecific level, while conspecific competition was set to a very low proportion. This choice is based on the standard invasion growth rate metric, or the population growth rate when rare, an important measure for quantifying population persistence (Lewontin and Cohen 1969).\nAdditionally, we performed the sensitivity analysis with the same conditions, except for changing the high competition from heterospecific to conspecific individuals. We observed that nearly all the variation in \\(\\lambda\\), previously attributed to the growth model, shifted to the recruitment model. Also, the importance attributed to the survival model for certain species at the center and cold temperature conditions shifted toward the recruitment model. Although we observed this shift, the overall patterns remained similar to those discussed earlier. The only exception was the distribution of relative importance between climate and competition Figure 16.6, where many species had an increase in the importance of competition relative to climate. These observed differences primarily arise from the high sensitivity of \\(\\lambda\\) to the \\(\\phi\\) parameter.\n\n\n\n\nAntoniadis, Anestis, Sophie Lambert-Lacroix, and Jean-Michel Poggi. 2021. “Random Forests for Global Sensitivity Analysis: A Selective Review.” Reliability Engineering & System Safety 206: 107312.\n\n\nBreiman, Leo. 2001. “Random Forests.” Machine Learning 45: 5–32.\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of North America: 1. Conifers; 2. Hardwoods Agriculture Handbook 654.” US Department of Agriculture, Forest Service, Washington, DC.\n\n\nCaswell, Hal. 1978. “A General Formula for the Sensitivity of Population Growth Rate to Changes in Life History Parameters.” Theoretical Population Biology 14 (2): 215–30.\n\n\nLewontin, Richard C, and Daniel Cohen. 1969. “On Population Growth in a Randomly Varying Environment.” Proceedings of the National Academy of Sciences 62 (4): 1056–60.\n\n\nSaltelli, Andrea, Ksenia Aleksankina, William Becker, Pamela Fennell, Federico Ferretti, Niels Holst, Sushan Li, and Qiongli Wu. 2019. “Why so Many Published Sensitivity Analyses Are False: A Systematic Review of Sensitivity Analysis Practices.” Environmental Modelling & Software 114: 29–39.\n\n\nWright, Marvin N., and Andreas Ziegler. 2017. “ranger: A Fast Implementation of Random Forests for High Dimensional Data in C++ and R.” Journal of Statistical Software 77 (1): 1–17. https://doi.org/10.18637/jss.v077.i01."
  },
  {
    "objectID": "conditional_lambda.html#competition-effect",
    "href": "conditional_lambda.html#competition-effect",
    "title": "17  Conditional effect of covariates",
    "section": "Competition effect",
    "text": "Competition effect\n\n\n\n\n\nFigure 17.1: The Average and 90% confidence interval values for the population growth rate (\\(\\lambda\\)) as a function of conspecific (left panel) and heterospecific (right panel) competition intensity."
  },
  {
    "objectID": "conditional_lambda.html#climate-effect",
    "href": "conditional_lambda.html#climate-effect",
    "title": "17  Conditional effect of covariates",
    "section": "Climate effect",
    "text": "Climate effect\n\n\n\n\nMean annual temperature\n\n\n\n\n\nFigure 17.2: The Average and 90% confidence interval values for the population growth rate (\\(\\lambda\\)) as a function of mean annual temperature for low (left panel) and high (right panel) competition intensity.\n\n\n\n\n\nMean annual precipitation\n\n\n\n\n\nFigure 17.3: The Average and 90% confidence interval values for the population growth rate (\\(\\lambda\\)) as a function of mean annual precipitation for low (left panel) and high (right panel) competition intensity."
  },
  {
    "objectID": "marginal_lambda.html#results",
    "href": "marginal_lambda.html#results",
    "title": "18  Marginal effect of covariates",
    "section": "Results",
    "text": "Results\nIn Figure 18.1, we show the sensitivity of each species’ population growth rate to conspecific and heterospecific competition, temperature, and precipitation. Among all species, \\(\\lambda\\) is more sensitive to temperature, followed by conspecific and heterospecific competition.\n\n\n\n\n\nFigure 18.1: Log sensitivity of species population growth rate to each conspecific competition, heterospecific competition, mean annual temperature, and mean annual precipitation across all plot-year observations. The smaller the values, the lower the sensitivity to a covariate.\n\n\n\n\nIn Figure 18.2, we integrate temperature with precipitation (climate) and conspecific with heterospecific competition to explore the relationship between sensitivity to climate and sensitivity to competition. Overall, species with high sensitivity to climate also exhibited high sensitivity to competition. Furthermore, most species displayed higher sensitivity to climate than to competition, and this difference widened as sensitivity levels increased.\n\n\n\n\n\nFigure 18.2: Comparison of sensitivity to climate with sensitivity to competition for each of the 31 forest species. The smaller the values, the lower the sensitivity to a covariate. The blue line is drawn from a linear smooth model and the black line is identity line.\n\n\n\n\nTo test how the sensitivity to each covariate changed across the species range, we classified each plot into cold, center, or hot temperature ranges based on MAT. Cold range plots had MAT below the 10th MAT quantile, while hot range plots had temperatures higher than the 90th MAT quantile. Everything in between was classified as a center plot. We describe the sensitivity of \\(\\lambda\\) among all species grouped by each of the four covariates in Figure 18.3. There were no significant differences in \\(\\lambda\\) sensitivity among these ranges within each covariate.\n\n\n\n\n\nFigure 18.3: Sensitivity of species population growth rate to each covariate grouped by the temperature range position. For each species, plots are classified as cold (MAT < 10th quantile), hot (MAT > 90th quantile), and center (10th < MAT < 90th quantile) given their average MAT across the years.\n\n\n\n\nWe then merged conspecific with heterospecific competition and temperature with precipitation to assess the relative sensitivity between competition and climate following Equation 18.2. The predominance of climate over competition was present in all three range positions, although \\(\\lambda\\) was more sensitive to competition in the cold range compared to the hot range (Figure 18.4).\n\n\n\n\n\nFigure 18.4: Relative sensitivity of species population growth rate to competition and climate grouped by the temperature range position. Negative values indicate higher sensitivity of \\(\\lambda\\) to climate, while positive values indicate higher sensitivity to competition.\n\n\n\n\nWhen analyzing the sensitivity at the species level, we observed higher temperature and precipitation sensitivity for species at the cold temperature ranges (Figure 18.5). This result indicates variability in \\(\\lambda\\) sensitivity with respect to their position in the temperature range.\n\n\n\n\n\nFigure 18.5: Sensitivity of species population growth rate to temperature and precipitation across their temperature range position. We defined each species’ temperature range position as the median Mean Annual Temperature across all observed plots.\n\n\n\n\nIn Figure 18.6, we analyze how the sensitivity to competition and climate and their ratio change across the temperature range. We can observe considerable variability among the species. Overall, species have lower sensitivity to competition compared to climate, and sensitivity to competition seems to be more stable across the temperature range compared to climate sensitivity.\n\n\n\n\n\nFigure 18.6: Sensitivity of species population growth rate to competition (green) and climate (yellow) along with their ratio across the species temperature range.\n\n\n\n\nAlthough we could not see much difference in the sensitivity to each covariate across the cold, center, and hot range among all species together (Figure 18.3), when analyzing each species individually, there are significant changes in the sensitivity ratio between competition and climate across the temperature range (Figure 18.7).\n\n\n\n\n\nFigure 18.7: Relative sensitivity of species population growth rate between competition and climate for cold (blue), center (green), and hot (red) temperature ranges.\n\n\n\n\nGiven the sensitivity to competition and climate as functions of the range position changes among the species (Figure 18.7), we extend Figure 18.3 by adding the position of each species on the temperature range to answer the question on how the sensitivity to each covariate changes across the species range. For that, we calculated the median of MAT for each species for all plots within the cold, center, and hot ranges. This allowed us to account for the difference in range position between the species to avoid comparing, for instance, the cold range of a boreal species with the cold range of a temperature one. Overall, for the species and range classes, the sensitivity of \\(\\lambda\\) to climate was higher than to the competition covariates (Figure 18.8). Except for sensitivity to climate at the hot range, all the other groups followed the pattern of increase in sensitivity as the species’ range position was located towards the colder mean annual temperatures. At the hot range of the species, the sensitivity to competition decreased towards hotter temperatures, while the climate sensitivity remained constant across the range of MAT. At the cold range of the species, the sensitivity to both competition and climate increased towards colder temperatures, with a higher increase rate for the climate than competition. Finally, at the center, the sensitivity to climate and competition increased towards colder temperatures, but there was no clear distinction between the two covariates.\n\n\n\n\n\nFigure 18.8: Bottom panels describe the sensitivity of species population growth rate to competition (green) and climate (yellow) across the cold, center, and hot temperature ranges. The top panels show the log ratio between competition and climate sensitivities, where negative values mean climate sensitivity is relatively higher than competition. We defined each species’ temperature range position as the median Mean Annual Temperature across all observed plots for each cold, center, and hot range class. In the bottom panel, species points are grouped by a Multivariate Normal Density function with 75% probability, while in the top panel, the lines represent the 25, 50, and 75% quantile probabilities.\n\n\n\n\nTo quantify the sensitivity difference between competition and climate, we analyze how the \\(ln(CCR)\\) for the cold, center, and hot range changes across the temperature range position of each species (Figure 18.8). Overall, the relative sensitivity of \\(\\lambda\\) to climate than competition increases towards the cold and hot ranges. While at the hot range, the increase in sensitivity to climate was due to the decrease in sensitivity to competition, at the cold range, it was due to a higher increase rate of climate than the competition. This is why we can observe a higher rate of increase in the relative sensitivity to climate in the hot range compared to the cold range. When analyzing across the species, the relative sensitivity to competition was higher at the center of the MAT range regardless of the cold or hot range positions.\n\n\n\nLastly, we analyzed how each species’ sensitivity to climate and competition changed from the cold to the hot border (Figure 18.9). The change in sensitivity between the cold and hot borders was contingent on the species’ position across the temperature range. For climate, species distributed toward colder temperature ranges often exhibited a decrease in sensitivity from the cold to the hot border. Conversely, most of the species located at the hot range distribution presented an increase in the sensitivity to climate at the hot border compared to the cold. Conversely, most species in the hot range distribution demonstrated an increase in sensitivity to climate at the hot border compared to the cold. For competition, most species presented a decrease in sensitivity from the cold to the hot border. Regarding competition, the majority of species displayed a decrease in sensitivity from the cold to the hot border regardless of their location in the temperature range. Furthermore, the decrease in sensitivity to competition from the cold to the hot border was more pronounced for species in colder temperatures.\n\n\n\n\n\nFigure 18.9: Difference in sensitivity of species population growth rate to climate (left) and competition between the cold and hot range limits. Each species is represented by a connected line linking their cold (circle) and hot (triangle) range positions, colored according to the difference between the cold and hot sensitivities. Note that uncertainty in each sensitivity point estimation has been omitted for clarity."
  },
  {
    "objectID": "marginal_lambda.html#spatial-distribution-of-sensitivity-to-the-covariates",
    "href": "marginal_lambda.html#spatial-distribution-of-sensitivity-to-the-covariates",
    "title": "18  Marginal effect of covariates",
    "section": "Spatial Distribution of sensitivity to the covariates",
    "text": "Spatial Distribution of sensitivity to the covariates\nSo far, we have discussed the sensitivity of \\(\\lambda\\) to competition and climate using averages across species and temperature range positions. Below, we summarize the raw observed sensitivity to competition, climate, and their ratio for each species-plot observation. For plots with more than one observation, we averaged each of the three metrics across the observations."
  },
  {
    "objectID": "extinction_risk.html#simulating-the-effect-of-demographic-uncertainty-and-environmental-stochasticity",
    "href": "extinction_risk.html#simulating-the-effect-of-demographic-uncertainty-and-environmental-stochasticity",
    "title": "19  Suitable probability",
    "section": "Simulating the effect of demographic uncertainty and environmental stochasticity",
    "text": "Simulating the effect of demographic uncertainty and environmental stochasticity\n\n\n\nIn this section, we investigate how increasing the uncertainty of parameters and the variability of covariates affects the suitable probability. We selected two species, Quercus prinus and Quercus rubra, with an average \\(\\lambda\\) close to 1, and were sensitive to competition and climate covariates. We set these species to conditions with population growth rates closest to 1 but with different average values (lower for Q. rubra and higher for Q. prinus) for comparison Figure 19.3.\n\n\n\n\n\nFigure 19.3: Population growth rate under demographic uncertainty from the 500 posterior distributions.\n\n\n\n\nWe used the same 500 parameter draws from the posterior distribution defined in the sensitivity analysis section (Chapter 16). We conducted four simulations to understand the cumulative impact of demographic uncertainty, environmental, and environmentally induced competition stochasticity. First, we quantified suitable probability under demographic uncertainty using the posterior parameter distribution while keeping the covariates at their mean conditions, effectively simulating zero noise from the covariates. Subsequently, we introduced environmental stochasticity and demographic uncertainty by adding noise to the mean temperature conditions. Similarly, we introduced noise to the mean basal area of heterospecific individuals while keeping temperature constant at the mean. Finally, we added all sources of variability together, encompassing demographic, environmental, and environmentally induced competition variability. We increased the standard deviation (SD) for temperature from 0.1 to 1.5, and for basal area, SD increased from 1 to 8.\nFigure 19.4 shows the changes in \\(\\lambda\\) variability with increased variability of the covariates. The panels illustrate the effect of climate stochasticity, competition stochasticity, and both combined factors.\n\n\n\n\n\nFigure 19.4: Distribution of population growth rate for different noise intensities applied to the temperature and basal area abundance covariates. We have omitted the values of \\(\\sigma\\) as they differ between the covariates. However, the noise increases from left to right.\n\n\n\n\nFigure 19.4 and Figure 19.5 highlight that increased noise around the average covariate conditions leads to higher variability in \\(\\lambda\\). It is important to note that the y-scale on the panels in Figure 19.5 is standardized, showing a higher \\(\\lambda\\) variability for Q. rubra compared to Q. prinus. This suggests that climate and competition are more significant predictors for all vital rates of Q. rubra compared to Q. prinus. In summary, higher variability in covariates will likely increase the variability in \\(\\lambda\\), proportional to the covariate sensitivity.\n\n\n\n\n\nFigure 19.5: Correlation between \\(\\lambda\\) standard deviation and variability intensity. The axis values of \\(\\sigma\\) have been omitted as they differ between the covariates. However, the noise increases from left to right. The line represents a smoothed approximation from the point data.\n\n\n\n\nOnce we determine the uncertainty in \\(\\lambda\\), we can calculate population-level suitable probability using the cumulative distribution function \\(F(\\lambda)\\). Figure 19.6 illustrates how suitable probability increases for Q. prinus and decreases for Q. rubra with increased variability of covariates.\n\n\n\n\n\nFigure 19.6: Correlation between suitable probability and variability intensity. The axis values of \\(\\sigma\\) have been omitted as they differ between the covariates. However, the noise increases from left to right. The line represents a smoothed approximation from the point data."
  },
  {
    "objectID": "extinction_risk.html#objective",
    "href": "extinction_risk.html#objective",
    "title": "19  Suitable probability",
    "section": "Objective",
    "text": "Objective\nThis exploration shows that parametric uncertainty and environmental stochasticity can increase \\(\\lambda\\) variability and change suitable probability. In this chapter, we want to assess the effect of spatio-temporal environmental variability and demographic uncertainty on the suitable probability of each species. Specifically, we aim to model how the suitable probability changes from the center toward the cold and hot temperature range distribution. By having the suitable probability varying across the temperature range, we can predict the effect of climate and competition, along with environmental variability and model uncertainty, on the range limits of forest trees. This new approach allows us to test whether species interaction (here competition) can set range limits while accounting for the uncertainty of the estimations. We conclude this study with a novel theory that uses suitable probability to establish the link between individual demographic rates and metapopulation dynamics."
  },
  {
    "objectID": "extinction_risk.html#methods",
    "href": "extinction_risk.html#methods",
    "title": "19  Suitable probability",
    "section": "Methods",
    "text": "Methods\n\nSources of population growth rate (\\(\\lambda\\)) variability\nThe estimation of \\(\\lambda\\) occurs at the local population scale, specifically at the plot level in our study. Within a given geographic location, such as a specific latitude where several plots are located, the variance of \\(\\lambda\\) among those plots arises from spatio-temporal variations in both climate and competition covariates. For instance, climate stochasticity introduces noise in annual temperature and precipitation, leading to environmental variations. Similarly, even with identical climate conditions, two locations can exhibit different community abundance and composition, resulting in variability in the strength of competition. Beyond these spatio-temporal environmentally-induced variations, \\(\\lambda\\) can still vary due to model uncertainty.\nIn our study, demographic models track uncertainty at two complementary scales: individual and plot levels. At the individual level, plots with the same climate and competition conditions may have different \\(\\lambda\\) values due to the uncertainty in the demographic models. Similarly, even with the same environmental conditions and averaged parameter values (eliminating demographic uncertainty at the individual level), two plots can still yield different \\(\\lambda\\) values due to the spatial uncertainty of each demographic model assigned among plots through the random effects. Therefore, variability in the population growth rate can arise from spatio-temporal variations in both the environment and the parameters.\n\n\nModeling suitable probability\nWe can evaluate the suitable probability of a species at various scales, ranging from a single local plot up to several plots in a region. At the plot level, sources of variability in \\(\\lambda\\) stem from parametric uncertainty at the individual level and temporal environmental stochasticity in climate and competition. When assessing suitable probability at the metapopulation scale by considering multiple plots simultaneously, we can additionally account for spatial variability in the environment and spatial uncertainty in plot-level parameters.\nWith the exception of parameter uncertainty at the individual level, all other sources of variability exhibit spatial dependence. This implies that environmental variability (from climate, competition, or both) and parameter uncertainty at the plot level can vary based on their spatial location. For instance, plots at the borders of the species distribution may experience more temperature variability than those at the center. Additionally, plot-level parametric uncertainty can be spatially structured, capturing potential features of demographic variability beyond the climatic and competition covariates, such as historical factors or local edaphic conditions.\nAt the metapopulation scale, we can model how suitable probability changes across the species’ range distribution, considering both fixed climate and competition effects and the underlying spatio-temporal variability. In our study, we are particularly interested in examining how suitable probability evolves from the center toward the cold and hot ranges. For that, we categorized all plot-year observations of a species based on the gradient of mean annual temperature (MAT), divided into cold and hot ranges using the MAT centroid among all plots (\\(\\frac{max(MAT) + min(MAT)}{2}\\)). We chose to use MAT instead of latitude because we are interested in the species’ climatic niche, although the two variables are highly correlated. The choice of MAT over latitude is motivated by our interest in understanding the species’ climatic niche. Despite our choice, MAT and latitude are highly correlated for all species.\nWe assessed suitable probability separately for the cold and hot ranges, employing a linear model to determine the relationship between \\(\\lambda\\) and MAT. The spatio-temporal variability of \\(\\lambda\\) arising from environmental stochasticity and parameter uncertainty influences the variance of the linear model. As this variance may change depending on the range position, we introduce a submodel for the variance of the linear model to be dependent on MAT. To accommodate potential asymmetry in this variance, we use a Skew Normal Distribution (\\(\\mathcal{SN}\\)) incorporating an additional parameter (\\(\\alpha\\)) that can introduce right or left-skewed tails to the variance:\n\\[\n\\begin{split}\n&log(\\lambda) \\sim \\mathcal{SN}(\\xi, \\omega, \\alpha) \\\\[2pt]\n&\\xi = \\beta_{1, \\xi} \\times MAT + \\beta_{0, \\xi} \\\\[2pt]\n&\\omega = e^{\\beta_{1, \\omega} \\times MAT + \\beta_{0, \\omega}}\n\\end{split}\n\\tag{19.3}\\]\nHere, \\(\\xi\\) is the location parameter or the \\(\\lambda\\) average, and \\(\\omega\\) is the scale representing the variance around the mean.\nIn Figure 19.7, we show some examples of the model’s flexibility. At each panel, two sets of parameter combinations illustrate the different behavior of the model. Each panel illustrates an element of the model attributed to accommodate the data variability. In panel 1, the most straightforward case shows how suitable probability changes linearly with MAT and constant variance. Panel 2 shows two cases with larger and smaller variances derived from the spatiotemporal variability of the conditions and model uncertainty. Panel 3 demonstrates how this variability can change across the range distribution. Finally, panel 4 shows how the asymmetry of the variability can bias the variance towards lower (yellow) or higher (green) values. Note that in panel 4, the illustration does not fully represent the asymmetry in the model, as the tool to create the curves does not allow asymmetric variance. Therefore, while the figure illustrates a shift in the average and variance, we should instead see a shift only in the variance.\n\n\n\n\n\n\n\n\nFigure 19.7: The linear model from the correlation between \\(\\lambda\\) and Mean annual temperature allows us to assess how suitable probability changes across the climate range. At each panel, two sets of parameter combination illustrate the different behaviour of the model. Each panel illustrates an element of the model attributed to accomodate the data variability.\n\n\n\n\n\n\nSimulations\nWe computed \\(\\lambda\\) for each species based on the plot-year observations in the dataset, considering both environmentally induced variability and parameter uncertainty. For every observed species-plot-year combination, we incorporated temporal stochasticity in climate conditions by using the mean and standard deviation of mean annual temperature and precipitation calculated from the years between measurements. For instance, in the case of a plot observed twice, we calculated \\(\\lambda\\) for the second observation with climate conditions drawn randomly from a normal distribution with mean and standard deviation defined from climate observations within the year interval. Similarly, temporal stochasticity in competition arises from variation in abundance and composition between measured years. By iteratively performing this calculation, drawing parameter values randomly from the posterior distribution, we introduced demographic uncertainty at the individual level. For each species-plot-year measurement, we replicated the calculation of \\(\\lambda\\) 100 times. By applying this approach across all plots, we naturally incorporate spatial variation in climate and competition conditions and spatial uncertainty in plot-level parameters.\nFor each species-plot-year-replication combination, we calculated \\(\\lambda\\) under two simulated conditions. The first condition assumed no competition, with heterospecific competition defined at zero and conspecific competition at a minimal proportion (total population size (\\(N\\)) = 0.1). This condition simulated the population growth rate under the fundamental niche. The second condition simulated the invasion growth rate, representing the population growth rate when the focal species is rare (\\(N = 0.1\\)) and heterospecific competition set to the observed abundance of the competitive species. This condition simulated the population growth rate under the realized niche. The code for these computations on High-performance computing is available on GitHub: https://github.com/willvieira/forest-IPM/tree/master/simulations/lambda_plot.\nAfter calculating \\(\\lambda\\) for each species-plot-year-replication combination, we used these estimates to fit the linear model describing how \\(\\lambda\\) and its variability change across the mean annual temperature gradient. We fitted the species-specific linear model for the hot and cold ranges using the Hamiltonian Monte Carlo (HMC) algorithm via the Stan software (version 2.30.1 Team et al. 2022) and the cmdstandr R package (version 0.5.3 Gabry, Češnovar, and Johnson 2023). To reduce the sampling time, we used a sample of 5000 plots for each species to fit the model. This sample was necessary only for 6 out of the 31 species. The R and Stan scripts for these computations on High-performance computing are accessible on GitHub: https://github.com/willvieira/forest-IPM/tree/master/simulations/model_lambdaPlot/.\nWith the fitted models, we leveraged the posterior distribution to estimate the suitable probability of a species for any value of MAT under fundamental or realized niche for the cold and hot ranges. Specifically, we estimated suitable probability under four different MAT conditions encountered by the species: at the border and the center of each cold and hot range. We defined the border of the cold range as the minimum observed MAT for the focal species in the dataset, while the hot range was defined as the maximum observed MAT. The center location is defined as the centroid of MAT for the focal species. Although the center location has the same MAT for the cold and hot ranges, both are retained because the model is fitted separately for the cold and hot ranges. Finally, we estimated suitable probability for each location under no competition (fundamental niche) and heterospecific competition (realized niche) conditions, using the empirical cumulative distribution function over 1000 predictive draws."
  },
  {
    "objectID": "extinction_risk.html#results",
    "href": "extinction_risk.html#results",
    "title": "19  Suitable probability",
    "section": "Results",
    "text": "Results\n\n\n\n\nExample using Abies balsemea\nWe used a linear model to summarize the evolution of the population growth rate (\\(\\lambda\\)) and its variability across the cold and warm ranges (Equation 19.3). The Figure 19.8 shows the observed \\(\\lambda\\) distribution and the fit of the underlying model on the mean annual temperature gradient for the species Abies balsamea. Each point represents a plot-year-replication encompassing the complete spatio-temporal sources of variability arising from the stochastic environment and parameter uncertainty. The black line represents the average fitted model (how \\(\\lambda\\) changes with MAT), and the shaded area is the 90th quantile of model uncertainty (how the variability of \\(\\lambda\\) changes with MAT). From this uncertainty, we can deduce the suitable probability. In this example, in the cold range, the mean and variance of \\(\\lambda\\) decrease towards the cold boundary. By comparing the model under heterospecific competition with that without competition, we can observe a slight decrease in the average at the cold border but a larger decrease in uncertainty (Figure 19.8 at the bottom left).\n\n\n\n\n\nFigure 19.8: Distribution of stochastic population growth rate (\\(\\lambda\\)) for Abies balsamea over the mean annual temperature gradient for cold (left panels) and warm (right panels) ranges under no competition (fundamental niche) and heterospecific competition (realized niche). The dots represent \\(\\lambda\\) over the plot-year-replication combinations. The model’s average line and 90% prediction intervals are estimated using 500 draws from the posterior distribution.\n\n\n\n\nWe can estimate the suitable probability using the empirical cumulative distribution approach (Equation 19.2) from the linear model predictions. The Figure 19.9 shows the suitable probability expected over the mean annual temperature of the same species. As expected, the suitable probability was reduced toward the cold border and was lower under heterospecific competition (yellow curve). We can also observe that the decrease in suitable probability toward the border is nonlinear, becoming more substantial for heterospecific competition than for the no-competition condition.\n\n\n\n\n\nFigure 19.9: Suitable probability of Abies balsamea over the mean annual temperature gradient for cold and warm ranges under no competition (green) and heterospecific (yellow). The vertical dotted line represents the range limits of the MAT observed in the dataset.\n\n\n\n\n\n\nEffect of climate and competition on suitable probability\nIn the final step, we analyze the effect of competition on the suitable probability at the border and center of the temperature range distribution for all species. The Figure 19.10 compares the suitable probability under no competition to those under heterospecific competition for four locations from the mean annual temperature gradient. Overall, suitable probability was high among the species, with an average of 0.78. Among the four locations, species presented a lower suitable probability at the border of the hot range, with an average of 0.67. Almost all species, in all conditions, are distributed below the identity line (1:1), meaning that heterospecific competition reduces the suitable probability. In the cold range, temperature decrease toward the border had little effect on the suitable probability for both competitive conditions. However, at the hot range, however, we can observe a significant shift in suitable probability from the center to the border. Across the temperature range, there is a monotonic decrease in suitable probability from the cold border toward the hot border.\n\n\n\n\n\n\n\n\nFigure 19.10: Suitable probability for the 31 forest species in their distribution from the cold to the hot border of the mean annual temperature gradient. Note that we omitted the parameter uncertainty of each species in this figure to avoid overlap and increase clarity.\n\n\n\n\nWhile the negative effect of climate on suitable probability is evident in the above figure, distinguishing the individual effects of competition remains challenging. Hence, in Figure 19.11, we assessed the impact of competition on reducing suitable probability by subtracting the suitable probability under heterospecific competition from the suitable probability with no competition. Even when isolating the effect of climate, the negative impact of heterospecific competition on suitable probability increases toward the border of the hot range.\n\n\n\n\n\nFigure 19.11: The effect of competition on suitable probability across the four range positions. Each species point is color-coded based on its shade tolerance following Burns, Honkala, et al. (1990).\n\n\n\n\nFor each species, we estimated the difference in suitable probability between the border and center (for climate) and between heterospecific and non-competition. In Figure 19.12, we compare the suitable probability for each species under the climate or competition conditions, where each line and their respective color determines the amount of change in suitable probability.\n\n\n\n\n\nFigure 19.12: Difference in suitable probability between the center and border of the distribution (left panels) and no competition and heterospecific competition (right) for the cold (top) and hot (bottom) ranges. The color of the line connecting each species’ conditions represents the intensity of change in suitable probability—the more intense the color, the greater the shift between conditions.\n\n\n\n\nWe further estimated the relative effect of climate and competition on changing suitable probability from the center to the border of the species distribution (Figure 19.13). Specifically, we quantified the distinct contributions of temperature and competition to changes in suitable probability. Positive values of the relative difference signify an increase in suitable probability from the center towards the border, negative values indicate a decrease, and zero implies no net change. In the hot range, most species exhibited negative values of the relative difference in suitable probability, indicating a decline in suitability due to higher temperature and intensified competition toward the hot border of the species distribution. At the cold range, most species showed positive values for the competition effect, meaning a reduction in the effect of competition toward the cold border. However, the climate effect at the cold range showed a less clear pattern, with some species experiencing an increase and others a decrease in suitable probability as temperature decreased toward the cold range. Overall, the relative difference in suitable probability from the center toward the border was more influenced by climate rather than competition.\n\n\n\n\n\nFigure 19.13: Difference in suitable probability for climate and competition effects over the cold and hot ranges. Negative values denote a decrease in species suitable probability from the center towards the distribution border, while positive values indicate an increase. Specifically, a negative value for climate at the hot (or cold) range signifies a reduction in suitable probability as temperature rises (or falls) towards the border.\n\n\n\n\nIn our investigation of whether suitable probability decreases simultaneously at both borders (indicating a unimodal shape) or exhibits a linear pattern from one border to the other (Figure 19.14), we found distinct patterns under the climate and competition effects. For the climate effect, the majority of species demonstrated a decrease in suitable probability at one border while the other remained unchanged. Additionally, a few species displayed a clear linear pattern of decreasing suitable probability from the cold to the hot border, with only one species (Betula papyrifera) showing a pronounced unimodal shape. Conversely, under the competition effect, most species exhibited a decrease in suitable probability at the hot border and an increase at the cold border, indicating a linear rise in the impact of competition from the cold to the hot border of the distribution.\n\n\n\n\n\nFigure 19.14: The relationship in the difference in suitable probability from the center to the border (\\(\\Delta\\Lambda\\)) between the cold and hot borders. A species at the bottom-left area (both \\(\\Delta\\Lambda\\) are negative) indicates an unimodal decrease in suitable probability at the borders. Conversely, species at the top-right square exhibit an inverse unimodal shape. In the top-left or bottom-right areas, suitable probability linearly decreases or increases from the cold toward the hot border, respectively. For the climate effect (left panel), species are colored following the centroid mean annual temperature among all observed plots. In the climate effect (left panel), species are color-coded based on the centroid of mean annual temperature among all observed plots. In the competition effect (right panel), species are classified by shade tolerance following Burns, Honkala, et al. (1990).\n\n\n\n\n\n\nSuitable probability across the mean annual temperature gradient\nWe further investigated the potential dependency of climate and competition effects on the geographical location of the species. Specifically, we hypothesized that the impact of climate might be more pronounced for species distributed in hotter temperatures than those in colder temperatures.  In Figure 19.15, we evaluated the difference in suitable probability for climate and competition effects along the mean annual temperature gradient. Notably, the only condition showing a significant trend was the climate effect in the cold range (blue group at the top panel). Not surprisingly, suitable probability decreased as temperature declined toward the cold range, but this pattern was observed only for species located in colder conditions. Conversely, the suitable probability increased when species were situated in hotter conditions as temperature decreased toward the cold range.\n\n\n\n\n\n\n\n\nFigure 19.15: Relative difference in suitable probability between the center and border for climate and competition for 31 species located over the mean annual temperature gradient. The difference in suitable probability for the climate effect is marginalized under the no-competition condition. Species points are grouped by a Multivariate Normal Density function with 75% probability."
  },
  {
    "objectID": "extinction_risk.html#appendices",
    "href": "extinction_risk.html#appendices",
    "title": "19  Suitable probability",
    "section": "Appendices",
    "text": "Appendices\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of North America: 1. Conifers; 2. Hardwoods Agriculture Handbook 654.” US Department of Agriculture, Forest Service, Washington, DC.\n\n\nGabry, Jonah, Rok Češnovar, and Andrew Johnson. 2023. Cmdstanr: R Interface to ’CmdStan’.\n\n\nHolt, Robert D, Timothy H Keitt, Mark a Lewis, Brian a Maurer, and Mark L Taper. 2005. “Theoretical models of species’ borders: single species approaches.” Oikos 108 (1): 18–27. https://doi.org/10.1111/j.0030-1299.2005.13147.x.\n\n\nTeam, Stan Development et al. 2022. “Stan Modeling Language Users Guide and Reference Manual, Version 2.30.1.” Stan Development Team."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Antoniadis, Anestis, Sophie Lambert-Lacroix, and Jean-Michel Poggi.\n2021. “Random Forests for Global Sensitivity Analysis: A Selective\nReview.” Reliability Engineering & System Safety\n206: 107312.\n\n\nBreiman, Leo. 2001. “Random Forests.” Machine\nLearning 45: 5–32.\n\n\nBriscoe, Natalie J., Jane Elith, Roberto Salguero-Gómez, José J.\nLahoz-Monfort, James S. Camac, Katherine M. Giljohann, Matthew H.\nHolden, et al. 2019. “Forecasting Species Range Dynamics with\nProcess-Explicit Models: Matching Methods to Applications.”\nEcology Letters 22 (11): 1940–56. https://doi.org/https://doi.org/10.1111/ele.13348.\n\n\nBurns, Russell M, Barbara H Honkala, et al. 1990. “Silvics of\nNorth America: 1. Conifers; 2. Hardwoods Agriculture Handbook\n654.” US Department of Agriculture, Forest Service,\nWashington, DC.\n\n\nCaswell, Hal. 1978. “A General Formula for the Sensitivity of\nPopulation Growth Rate to Changes in Life History Parameters.”\nTheoretical Population Biology 14 (2): 215–30.\n\n\nCsergő, Anna M., Roberto Salguero-Gómez, Olivier Broennimann, Shaun R.\nCoutts, Antoine Guisan, Amy L. Angert, Erik Welk, et al. 2017.\n“Less Favourable Climates Constrain Demographic Strategies in\nPlants.” Ecology Letters 20 (8): 969–80.\nhttps://doi.org/https://doi.org/10.1111/ele.12794.\n\n\nDı́az, Sandra, Jens Kattge, Johannes HC Cornelissen, Ian J Wright, Sandra\nLavorel, Stéphane Dray, Björn Reu, et al. 2022. “The Global\nSpectrum of Plant Form and Function: Enhanced Species-Level Trait\nDataset.” Scientific Data 9 (1): 755.\n\n\nEasterling, Michael R., Stephen P. Ellner, and Philip M. Dixon. 2000.\n“Size-specific sensitivity: applying a new\nstructured population model.” Ecology 81 (3):\n694–708. https://doi.org/10.1890/0012-9658(2000)081[0694:SSSAAN]2.0.CO;2.\n\n\nEllner, Stephen P, Dylan Z Childs, and Mark Rees. 2016. Data-driven modelling of structured\npopulations. Springer.\n\n\nEttinger, Ailene, and Janneke HilleRisLambers. 2017. “Competition and facilitation may lead to asymmetric range\nshift dynamics with climate change.” Global Change\nBiology 23 (9): 3921–33. https://doi.org/10.1111/gcb.13649.\n\n\nGabry, Jonah, Rok Češnovar, and Andrew Johnson. 2023. Cmdstanr: R\nInterface to ’CmdStan’.\n\n\nGuyennon, Arnaud, Björn Reineking, Roberto Salguero-Gomez, Jonas\nDahlgren, Aleksi Lehtonen, Sophia Ratcliffe, Paloma Ruiz-Benito, Miguel\nA. Zavala, and Georges Kunstler. 2023. “Beyond Mean Fitness:\nDemographic Stochasticity and Resilience Matter at Tree Species Climatic\nEdges.” Global Ecology and Biogeography 32 (4): 573–85.\nhttps://doi.org/https://doi.org/10.1111/geb.13640.\n\n\nHolt, Robert D. 2009. “Bringing the Hutchinsonian Niche into the\n21st Century: Ecological and Evolutionary Perspectives.”\nProceedings of the National Academy of Sciences 106\n(supplement_2): 19659–65.\n\n\nHolt, Robert D, Timothy H Keitt, Mark a Lewis, Brian a Maurer, and Mark\nL Taper. 2005. “Theoretical models of\nspecies’ borders: single species approaches.”\nOikos 108 (1): 18–27. https://doi.org/10.1111/j.0030-1299.2005.13147.x.\n\n\nHutchinson, G Evelyn. 1957. “Concluding\nremarks.” In Cold Spring Harbor Symposium on\nQuantitative Biology, 22:415–27.\n\n\nIbáñez, Inés, Donald R. Zak, Andrew J. Burton, and Kurt S. Pregitzer.\n2018. “Anthropogenic nitrogen deposition\nameliorates the decline in tree growth caused by a drier\nclimate.” Ecology, January. https://doi.org/10.1002/ecy.2095.\n\n\nKohyama, Takashi. 1992. “Size-Structured Multi-Species Model of\nRain Forest Trees.” Functional Ecology, 206–12.\n\n\nKunstler, Georges, Arnaud Guyennon, Sophia Ratcliffe, Nadja Rüger,\nPaloma Ruiz-Benito, Dylan Z. Childs, Jonas Dahlgren, et al. 2021.\n“Demographic performance of European tree\nspecies at their hot and cold climatic edges.” Journal\nof Ecology 109 (2): 1041–54. https://doi.org/10.1111/1365-2745.13533.\n\n\nLe Squin, Amaël, Isabelle Boulangeat, and Dominique Gravel. 2021.\n“Climate-Induced Variation in the Demography of 14 Tree Species Is\nNot Sufficient to Explain Their Distribution in Eastern North\nAmerica.” Global Ecology and Biogeography 30 (2):\n352–69. https://doi.org/https://doi.org/10.1111/geb.13209.\n\n\nLewontin, Richard C, and Daniel Cohen. 1969. “On Population Growth\nin a Randomly Varying Environment.” Proceedings of the\nNational Academy of Sciences 62 (4): 1056–60.\n\n\nMaguire Jr, Bassett. 1973. “Niche Response Structure and the\nAnalytical Potentials of Its Relationship to the Habitat.”\nThe American Naturalist 107 (954): 213–46.\n\n\nMcKenney, Daniel W, Michael F Hutchinson, Pia Papadopol, Kevin Lawrence,\nJohn Pedlar, Kathy Campbell, Ewa Milewska, Ron F Hopkinson, David Price,\nand Tim Owen. 2011. “Customized Spatial Climate Models for North\nAmerica.” Bulletin of the American Meteorological\nSociety 92 (12): 1611–22.\n\n\nMinistere des Ressources Naturelles. 2016. “Norme d’inventaire ecoforestier: placettes-echantillons\ntemporaires.” Direction des inventaires forestier,\nMinistère des Ressources naturelles,Québec.\n\n\nO’Connell, M B, E B LaPoint, J A Turner, T Ridley, D Boyer, A Wilson, K\nL Waddell, and B L Conkling. 2007. “The\nforest inventory and analysis database: Database description and users\nforest inventory and analysis program.” US Department of\nAgriculture, Forest Service.\n\n\nSaltelli, Andrea, Ksenia Aleksankina, William Becker, Pamela Fennell,\nFederico Ferretti, Niels Holst, Sushan Li, and Qiongli Wu. 2019.\n“Why so Many Published Sensitivity Analyses Are False: A\nSystematic Review of Sensitivity Analysis Practices.”\nEnvironmental Modelling & Software 114: 29–39.\n\n\nSchurr, Frank M., Jörn Pagel, Juliano Sarmento Cabral, Jürgen\nGroeneveld, Olga Bykova, Robert B. O’Hara, Florian Hartig, et al. 2012.\n“How to understand species’ niches and range\ndynamics: A demographic research agenda for biogeography.”\nJournal of Biogeography 39 (12): 2146–62. https://doi.org/10.1111/j.1365-2699.2012.02737.x.\n\n\nSeidl, Rupert, Mart-Jan Schelhaas, and Manfred J Lexer. 2011.\n“Unraveling the Drivers of Intensifying Forest Disturbance Regimes\nin Europe.” Global Change Biology 17 (9): 2842–52.\n\n\nSittaro, Fabian, Alain Paquette, Christian Messier, and Charles A. Nock.\n2017. “Tree range expansion in eastern North\nAmerica fails to keep pace with climate warming at northern range\nlimits.” Global Change Biology, 1–10. https://doi.org/10.1111/gcb.13622.\n\n\nTeam, Stan Development et al. 2022. “Stan Modeling Language Users\nGuide and Reference Manual, Version 2.30.1.” Stan Development\nTeam.\n\n\nTredennick, Andrew T., Giles Hooker, Stephen P. Ellner, and Peter B.\nAdler. 2021. “A Practical Guide to Selecting Models for\nExploration, Inference, and Prediction in Ecology.”\nEcology 102 (6): e03336. https://doi.org/https://doi.org/10.1002/ecy.3336.\n\n\nVehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. “Practical\nBayesian Model Evaluation Using Leave-One-Out Cross-Validation and\nWAIC.” Statistics and Computing 27: 1413–32.\n\n\nVon Bertalanffy, Ludwig. 1957. “Quantitative Laws in Metabolism\nand Growth.” The Quarterly Review of Biology 32 (3):\n217–31.\n\n\nWright, Marvin N., and Andreas Ziegler. 2017. “ranger: A Fast Implementation of Random Forests\nfor High Dimensional Data in C++ and\nR.” Journal of Statistical Software 77 (1):\n1–17. https://doi.org/10.18637/jss.v077.i01.\n\n\nZhang, Jian, Shongming Huang, and Fangliang He. 2015.\n“Half-Century Evidence from Western Canada Shows Forest Dynamics\nAre Primarily Driven by Competition Followed by Climate.”\nProceedings of the National Academy of Sciences 112 (13):\n4009–14.\n\n\nZuidema, Pieter A, Eelke Jongejans, Pham D Chien, Heinjo J During, and\nFeike Schieving. 2010. “Integral Projection Models for Trees: A\nNew Parameterization Method and a Validation of Model Output.”\nJournal of Ecology 98 (2): 345–55."
  }
]